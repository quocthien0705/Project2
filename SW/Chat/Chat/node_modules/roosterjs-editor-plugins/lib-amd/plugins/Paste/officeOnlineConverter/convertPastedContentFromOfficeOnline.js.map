{"version":3,"file":"convertPastedContentFromOfficeOnline.js","sourceRoot":"","sources":["../../../../../../packages/roosterjs-editor-plugins/lib/plugins/Paste/officeOnlineConverter/convertPastedContentFromOfficeOnline.ts"],"names":[],"mappings":";;;IAMA,IAAM,qBAAqB,GACvB,kHAAkH,CAAC;IACvH,IAAM,yBAAyB,GAAG;QAC9B,wBAAwB;QACxB,yBAAyB;QACzB,0BAA0B;QAC1B,2BAA2B;QAC3B,wBAAwB;QACxB,qBAAqB;KACxB;SACI,GAAG,CAAC,UAAA,SAAS,IAAI,OAAA,MAAI,SAAW,EAAf,CAAe,CAAC;SACjC,IAAI,CAAC,GAAG,CAAC,CAAC;IACf;;;;;;OAMG;IACH,SAAwB,oCAAoC,CACxD,QAA0B,EAC1B,gBAAgD;QAEhD,QAAQ,CAAC,gBAAgB,CAAC,qBAAqB,CAAC,CAAC,OAAO,CAAC,UAAC,EAAW;YACjE,IAAM,OAAO,GAAG,EAAiB,CAAC;YAClC,OAAO,CAAC,KAAK,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;YACxC,OAAO,CAAC,KAAK,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC;QAC3C,CAAC,CAAC,CAAC;QACH,yEAAyE;QACzE,0CAA0C;QAC1C,IAAI,IAAA,yDAAoB,EAAC,QAAQ,CAAC,EAAE;YAChC,IAAA,4CAAkC,EAAC,QAAQ,CAAC,CAAC;SAChD;QAED,8DAA8D;QAC9D,gGAAgG;QAChG,sEAAsE;QACtE,IAAA,6CAAsB,EAClB,gBAAgB,CAAC,iBAAiB,EAClC,QAAQ,EACR,UAAC,KAAK,EAAE,OAAO,IAAK,OAAA,OAAO,CAAC,OAAO,IAAI,KAAK,IAAI,KAAK,IAAI,MAAM,EAA3C,CAA2C,CAClE,CAAC;QAEF,QAAQ;aACH,gBAAgB,CAAC,yBAAyB,CAAC;aAC3C,OAAO,CAAC,UAAA,IAAI,YAAI,OAAA,MAAA,IAAI,CAAC,aAAa,0CAAE,WAAW,CAAC,IAAI,CAAC,CAAA,EAAA,CAAC,CAAC;IAChE,CAAC;IA3BD,uDA2BC","sourcesContent":["import { chainSanitizerCallback } from 'roosterjs-editor-dom';\nimport type { HtmlSanitizerOptions } from 'roosterjs-editor-types';\nimport convertPastedContentFromWordOnline, {\n    isWordOnlineWithList,\n} from './convertPastedContentFromWordOnline';\n\nconst WAC_IDENTIFY_SELECTOR =\n    'ul[class^=\"BulletListStyle\"]>.OutlineElement,ol[class^=\"NumberListStyle\"]>.OutlineElement,span.WACImageContainer';\nconst TABLE_TEMP_ELEMENTS_QUERY = [\n    'TableInsertRowGapBlank',\n    'TableColumnResizeHandle',\n    'TableCellTopBorderHandle',\n    'TableCellLeftBorderHandle',\n    'TableHoverColumnHandle',\n    'TableHoverRowHandle',\n]\n    .map(className => `.${className}`)\n    .join(',');\n/**\n * @internal\n * Convert pasted content from Office Online\n * Once it is known that the document is from WAC\n * We need to remove the display property and margin from all the list item\n * @param event The BeforePaste event\n */\nexport default function convertPastedContentFromOfficeOnline(\n    fragment: DocumentFragment,\n    sanitizingOption: Required<HtmlSanitizerOptions>\n) {\n    fragment.querySelectorAll(WAC_IDENTIFY_SELECTOR).forEach((el: Element) => {\n        const element = el as HTMLElement;\n        element.style.removeProperty('display');\n        element.style.removeProperty('margin');\n    });\n    // call conversion function if the pasted content is from word online and\n    // has list element in the pasted content.\n    if (isWordOnlineWithList(fragment)) {\n        convertPastedContentFromWordOnline(fragment);\n    }\n\n    // Remove \"border:none\" for image to fix image resize behavior\n    // We found a problem that when paste an image with \"border:none\" then the resize border will be\n    // displayed incorrectly when resize it. So we need to drop this style\n    chainSanitizerCallback(\n        sanitizingOption.cssStyleCallbacks,\n        'border',\n        (value, element) => element.tagName != 'IMG' || value != 'none'\n    );\n\n    fragment\n        .querySelectorAll(TABLE_TEMP_ELEMENTS_QUERY)\n        .forEach(node => node.parentElement?.removeChild(node));\n}\n"]}