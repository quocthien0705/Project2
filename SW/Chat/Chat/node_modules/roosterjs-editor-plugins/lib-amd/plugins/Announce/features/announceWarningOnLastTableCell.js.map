{"version":3,"file":"announceWarningOnLastTableCell.js","sourceRoot":"","sources":["../../../../../../packages/roosterjs-editor-plugins/lib/plugins/Announce/features/announceWarningOnLastTableCell.ts"],"names":[],"mappings":";;;;IAIA,IAAM,mBAAmB,GAAG,OAAO,CAAC;IACpC,IAAM,cAAc,GAAG,OAAO,CAAC;IAE/B;;OAEG;IACU,QAAA,yBAAyB,GAAoB;QACtD,YAAY,EAAE,UAAC,MAAM,EAAE,kBAAkB;YACrC,IAAM,SAAS,GAAG,MAAM,CAAC,mBAAmB,EAAE,CAAC;YAE/C,OAAO,CACH,CAAA,SAAS,aAAT,SAAS,uBAAT,SAAS,CAAE,IAAI,mBAA8B;gBAC7C,SAAS,CAAC,eAAe;gBACzB,SAAS,CAAC,MAAM,CAAC,MAAM,KAAK,CAAC;gBAC7B,CAAC,IAAA,+BAAQ,EACL,kBAAkB,EAClB,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,cAAc,EAClC,IAAI,CAAC,0BAA0B,CAClC;gBACD,UAAU,EAAE,IAAI;gBACZ,cAAc,iCAA8C;aAC/D,CACJ,CAAC;YACF,SAAS,UAAU;gBACf,IAAM,KAAK,GAAG,MAAM,CAAC,kBAAkB,CAAC,cAAc,CAAC,CAAC;gBAExD,IAAI,IAAA,qCAAc,EAAC,KAAK,EAAE,kBAAkB,CAAC,EAAE;oBAC3C,IAAM,QAAQ,GAAG,KAAK,CAAC,gBAAgB,CAAC,mBAAmB,CAAC,CAAC;oBAC7D,IAAM,WAAW,GAAG,MAAM,CAAC,kBAAkB,CAAC,mBAAmB,CAAC,CAAC;oBAEnE,OAAO,WAAW,IAAI,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;iBAC5D;gBACD,OAAO,KAAK,CAAC;YACjB,CAAC;QACL,CAAC;QACD,IAAI,EAAE,wEAAqD;KAC9D,CAAC","sourcesContent":["import { contains, safeInstanceOf } from 'roosterjs-editor-dom';\nimport { Keys, KnownAnnounceStrings, SelectionRangeTypes } from 'roosterjs-editor-types';\nimport type { AnnounceFeature } from '../AnnounceFeature';\n\nconst TABLE_CELL_SELECTOR = 'td,th';\nconst TABLE_SELECTOR = 'table';\n\n/**\n * @internal\n */\nexport const announceWarningOnLastCell: AnnounceFeature = {\n    shouldHandle: (editor, lastFocusedElement) => {\n        const selection = editor.getSelectionRangeEx();\n\n        return (\n            selection?.type == SelectionRangeTypes.Normal &&\n            selection.areAllCollapsed &&\n            selection.ranges.length === 1 &&\n            !contains(\n                lastFocusedElement,\n                selection.ranges[0].startContainer,\n                true /*treatSameNodeAsContain*/\n            ) &&\n            isLastCell() && {\n                defaultStrings: KnownAnnounceStrings.AnnounceOnFocusLastCell,\n            }\n        );\n        function isLastCell(): boolean {\n            const table = editor.getElementAtCursor(TABLE_SELECTOR);\n\n            if (safeInstanceOf(table, 'HTMLTableElement')) {\n                const allCells = table.querySelectorAll(TABLE_CELL_SELECTOR);\n                const focusedCell = editor.getElementAtCursor(TABLE_CELL_SELECTOR);\n\n                return focusedCell == allCells.item(allCells.length - 1);\n            }\n            return false;\n        }\n    },\n    keys: [Keys.TAB, Keys.UP, Keys.DOWN, Keys.LEFT, Keys.RIGHT],\n};\n"]}