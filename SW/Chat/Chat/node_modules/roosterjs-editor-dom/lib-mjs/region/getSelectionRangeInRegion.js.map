{"version":3,"file":"getSelectionRangeInRegion.js","sourceRoot":"","sources":["../../../../packages/roosterjs-editor-dom/lib/region/getSelectionRangeInRegion.ts"],"names":[],"mappings":"AAAA,OAAO,WAAW,MAAM,0BAA0B,CAAC;AACnD,OAAO,QAAQ,MAAM,uBAAuB,CAAC;AAC7C,OAAO,EAAE,kBAAkB,EAAE,sBAAsB,EAAE,MAAM,yBAAyB,CAAC;AAGrF;;;;;GAKG;AACH,MAAM,CAAC,OAAO,UAAU,yBAAyB,CAAC,UAAsB;IACpE,IAAI,CAAC,UAAU,EAAE;QACb,OAAO,IAAI,CAAC;KACf;IAEO,IAAA,UAAU,GAAoC,UAAU,WAA9C,EAAE,SAAS,GAAyB,UAAU,UAAnC,EAAE,QAAQ,GAAe,UAAU,SAAzB,EAAE,QAAQ,GAAK,UAAU,SAAf,CAAgB;IACjE,IAAM,SAAS,GAAG,UAAU;QACxB,CAAC,CAAC,kBAAkB,CAAC,UAAU,CAAC,QAAQ,EAAE,UAAU,EAAE,UAAU,CAAC,QAAQ,CAAC;QAC1E,CAAC,CAAC,QAAQ,CAAC,UAAU,CAAC;IAC1B,IAAM,OAAO,GAAG,SAAS;QACrB,CAAC,CAAC,sBAAsB,CAAC,QAAQ,EAAE,SAAS,EAAE,QAAQ,CAAC;QACvD,CAAC,CAAC,QAAQ,CAAC,SAAS,CAAC;IACzB,IAAM,WAAW,GAAG,SAAS,IAAI,OAAO,IAAI,WAAW,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC;IAE5E,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,EAAE;QACvB,OAAO,WAAW,CAAC;KACtB;SAAM,IAAI,WAAW,EAAE;QACpB,IAAM,WAAW,GAAG,QAAQ,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC,SAAS,EAAE,CAAC;QAC/D,IAAM,SAAS,GAAG,QAAQ,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC,SAAS,EAAE,CAAC;QACnD,IAAA,gBAAgB,GAAyB,UAAU,iBAAnC,EAAE,kBAAkB,GAAK,UAAU,mBAAf,CAAgB;QAE5D,IAAI,CAAC,kBAAkB,CAAC,OAAO,CAAC,SAAS,CAAC,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,gBAAgB,CAAC,EAAE;YAClF,IAAM,KAAK,GAAG,kBAAkB,CAAC,OAAO,CAAC,WAAW,CAAC;gBACjD,CAAC,CAAC,kBAAkB;gBACpB,CAAC,CAAC,WAAW,CAAC;YAClB,IAAM,GAAG,GAAG,gBAAgB,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,gBAAgB,CAAC;YAE/E,OAAO,WAAW,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;SAClC;KACJ;IAED,OAAO,IAAI,CAAC;AAChB,CAAC;AAED,SAAS,QAAQ,CAAC,UAAsB;IACpC,IAAM,MAAM,GAAG,UAAoB,CAAC;IACpC,OAAO,CAAC,CAAC,MAAM,CAAC,gBAAgB,IAAI,CAAC,CAAC,MAAM,CAAC,kBAAkB,CAAC;AACpE,CAAC","sourcesContent":["import createRange from '../selection/createRange';\nimport Position from '../selection/Position';\nimport { getNextLeafSibling, getPreviousLeafSibling } from '../utils/getLeafSibling';\nimport type { Region, RegionBase } from 'roosterjs-editor-types';\n\n/**\n * Get the selection range in the given region.\n * The original range can cover multiple regions, this function will narrow the original selection\n * of a region into current region\n * @param regionBase The region to get range from\n */\nexport default function getSelectionRangeInRegion(regionBase: RegionBase): Range | null {\n    if (!regionBase) {\n        return null;\n    }\n\n    const { nodeBefore, nodeAfter, rootNode, skipTags } = regionBase;\n    const startNode = nodeBefore\n        ? getNextLeafSibling(regionBase.rootNode, nodeBefore, regionBase.skipTags)\n        : rootNode.firstChild;\n    const endNode = nodeAfter\n        ? getPreviousLeafSibling(rootNode, nodeAfter, skipTags)\n        : rootNode.lastChild;\n    const regionRange = startNode && endNode && createRange(startNode, endNode);\n\n    if (!isRegion(regionBase)) {\n        return regionRange;\n    } else if (regionRange) {\n        const regionStart = Position.getStart(regionRange).normalize();\n        const regionEnd = Position.getEnd(regionRange).normalize();\n        const { fullSelectionEnd, fullSelectionStart } = regionBase;\n\n        if (!fullSelectionStart.isAfter(regionEnd) && !regionStart.isAfter(fullSelectionEnd)) {\n            const start = fullSelectionStart.isAfter(regionStart)\n                ? fullSelectionStart\n                : regionStart;\n            const end = fullSelectionEnd.isAfter(regionEnd) ? regionEnd : fullSelectionEnd;\n\n            return createRange(start, end);\n        }\n    }\n\n    return null;\n}\n\nfunction isRegion(regionBase: RegionBase): regionBase is Region {\n    const region = regionBase as Region;\n    return !!region.fullSelectionEnd && !!region.fullSelectionStart;\n}\n"]}