{"version":3,"file":"addRangeToSelection.js","sourceRoot":"","sources":["../../../../packages/roosterjs-editor-dom/lib/selection/addRangeToSelection.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,OAAO,EAAE,MAAM,kBAAkB,CAAC;AAE3C;;;;;;GAMG;AACH,MAAM,CAAC,OAAO,UAAU,mBAAmB,CAAC,KAAY,EAAE,aAAuB;;IAC7E,IAAM,SAAS,GAAG,MAAA,MAAA,MAAA,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,uBAAuB,0CAAE,aAAa,0CAAE,WAAW,0CAAE,YAAY,EAAE,CAAC;IAC7F,IAAI,SAAS,EAAE;QACX,IAAI,YAAY,GAAG,IAAI,CAAC;QAExB,IAAI,SAAS,CAAC,UAAU,GAAG,CAAC,EAAE;YAC1B,mCAAmC;YACnC,IAAI;gBACA,IAAI,YAAY,GAAiB,IAAI,CAAC;gBACtC,6EAA6E;gBAC7E,oFAAoF;gBACpF,IACI,CAAC,aAAa,IAAI,OAAO,CAAC,MAAM,CAAC;oBACjC,CAAC,YAAY,GAAG,SAAS,CAAC,UAAU,IAAI,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;oBAC3E,YAAY,CAAC,cAAc,IAAI,KAAK,CAAC,cAAc;oBACnD,YAAY,CAAC,WAAW,IAAI,KAAK,CAAC,WAAW;oBAC7C,YAAY,CAAC,YAAY,IAAI,KAAK,CAAC,YAAY;oBAC/C,YAAY,CAAC,SAAS,IAAI,KAAK,CAAC,SAAS,EAC3C;oBACE,YAAY,GAAG,KAAK,CAAC;iBACxB;qBAAM;oBACH,SAAS,CAAC,eAAe,EAAE,CAAC;iBAC/B;aACJ;YAAC,OAAO,CAAC,EAAE,GAAE;SACjB;QAED,IAAI,YAAY,EAAE;YACd,SAAS,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;SAC7B;KACJ;AACL,CAAC","sourcesContent":["import { Browser } from '../utils/Browser';\n\n/**\n * Add the given range into selection of the given document\n * @param range The range to select\n * @param skipSameRange When set to true, do nothing if the given range is the same with current selection,\n * otherwise it will always remove current selection range and set to the given one.\n * This parameter is always treat as true in Edge to avoid some weird runtime exception.\n */\nexport default function addRangeToSelection(range: Range, skipSameRange?: boolean) {\n    const selection = range?.commonAncestorContainer?.ownerDocument?.defaultView?.getSelection();\n    if (selection) {\n        let needAddRange = true;\n\n        if (selection.rangeCount > 0) {\n            // Workaround IE exception 800a025e\n            try {\n                let currentRange: Range | null = null;\n                // Do not remove/add range if current selection is the same with target range\n                // Without this check, execCommand() may fail in Edge since we changed the selection\n                if (\n                    (skipSameRange || Browser.isEdge) &&\n                    (currentRange = selection.rangeCount == 1 ? selection.getRangeAt(0) : null) &&\n                    currentRange.startContainer == range.startContainer &&\n                    currentRange.startOffset == range.startOffset &&\n                    currentRange.endContainer == range.endContainer &&\n                    currentRange.endOffset == range.endOffset\n                ) {\n                    needAddRange = false;\n                } else {\n                    selection.removeAllRanges();\n                }\n            } catch (e) {}\n        }\n\n        if (needAddRange) {\n            selection.addRange(range);\n        }\n    }\n}\n"]}