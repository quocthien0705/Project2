{"version":3,"file":"getSelectedBlockElementsInRegion.js","sourceRoot":"","sources":["../../../../packages/roosterjs-editor-dom/lib/region/getSelectedBlockElementsInRegion.ts"],"names":[],"mappings":";;;IAQA;;;;;;OAMG;IACH,SAAwB,gCAAgC,CACpD,UAAsB,EACtB,kBAA4B,EAC5B,UAAoB;QAEpB,IAAM,KAAK,GAAG,IAAA,mCAAyB,EAAC,UAAU,CAAC,CAAC;QACpD,IAAI,MAAM,GAAmB,EAAE,CAAC;QAEhC,IAAI,KAAK,EAAE;YACC,IAAA,QAAQ,GAAe,UAAU,SAAzB,EAAE,QAAQ,GAAK,UAAU,SAAf,CAAgB;YAC1C,IAAM,SAAS,GAAG,0BAAgB,CAAC,wBAAwB,CAAC,QAAQ,EAAE,KAAK,EAAE,QAAQ,CAAC,CAAC;YAEvF,KACI,IAAI,KAAK,GAAG,SAAS,aAAT,SAAS,uBAAT,SAAS,CAAE,mBAAmB,EAC1C,CAAC,CAAC,KAAK,EACP,KAAK,GAAG,SAAS,CAAC,mBAAmB,EAAE,EACzC;gBACE,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;aACtB;YAED,2BAA2B;YAC3B,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC,UAAA,KAAK;;gBACxB,IAAM,SAAS,GAAG,KAAK,CAAC,YAAY,EAAE,CAAC;gBACvC,IAAM,OAAO,GAAG,KAAK,CAAC,UAAU,EAAE,CAAC;gBAEnC,IAAI,SAAS,IAAI,OAAO,IAAI,IAAA,wBAAc,EAAC,SAAS,EAAE,IAAI,CAAC,eAAe,CAAC,EAAE;oBACzE,MAAA,SAAS,CAAC,UAAU,0CAAE,WAAW,CAAC,SAAS,CAAC,CAAC;oBAC7C,OAAO,KAAK,CAAC;iBAChB;qBAAM;oBACH,OAAO,IAAI,CAAC;iBACf;YACL,CAAC,CAAC,CAAC;SACN;QAED,IAAI,MAAM,CAAC,MAAM,IAAI,CAAC,IAAI,UAAU,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,UAAU,IAAI,kBAAkB,EAAE;YAC3F,IAAM,OAAO,GAAG,IAAA,uBAAa,qBAEzB,UAAU,CAAC,QAAQ,CAAC,aAAa,CACpC,CAAC;YACF,UAAU,CAAC,QAAQ,CAAC,WAAW,CAAC,OAAQ,CAAC,CAAC;YAE1C,IAAM,KAAK,GAAG,IAAA,+BAAqB,EAAC,UAAU,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;YAElE,IAAI,KAAK,EAAE;gBACP,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;aACtB;SACJ;QAED,OAAO,MAAM,CAAC;IAClB,CAAC;IAjDD,mDAiDC","sourcesContent":["import ContentTraverser from '../contentTraverser/ContentTraverser';\nimport createElement from '../utils/createElement';\nimport getBlockElementAtNode from '../blockElements/getBlockElementAtNode';\nimport getSelectionRangeInRegion from './getSelectionRangeInRegion';\nimport shouldSkipNode from '../utils/shouldSkipNode';\nimport { KnownCreateElementDataIndex } from 'roosterjs-editor-types';\nimport type { BlockElement, RegionBase } from 'roosterjs-editor-types';\n\n/**\n * Get all block elements covered by the selection under this region\n * @param regionBase The region to get block elements from\n * @param createBlockIfEmpty When set to true, a new empty block element will be created if there is not\n * any blocks in the region. Default value is false\n * @param deprecated Deprecated parameter, not used\n */\nexport default function getSelectedBlockElementsInRegion(\n    regionBase: RegionBase,\n    createBlockIfEmpty?: boolean,\n    deprecated?: boolean\n): BlockElement[] {\n    const range = getSelectionRangeInRegion(regionBase);\n    let blocks: BlockElement[] = [];\n\n    if (range) {\n        const { rootNode, skipTags } = regionBase;\n        const traverser = ContentTraverser.createSelectionTraverser(rootNode, range, skipTags);\n\n        for (\n            let block = traverser?.currentBlockElement;\n            !!block;\n            block = traverser.getNextBlockElement()\n        ) {\n            blocks.push(block);\n        }\n\n        // Remove meaningless nodes\n        blocks = blocks.filter(block => {\n            const startNode = block.getStartNode();\n            const endNode = block.getEndNode();\n\n            if (startNode == endNode && shouldSkipNode(startNode, true /*ignoreSpace*/)) {\n                startNode.parentNode?.removeChild(startNode);\n                return false;\n            } else {\n                return true;\n            }\n        });\n    }\n\n    if (blocks.length == 0 && regionBase && !regionBase.rootNode.firstChild && createBlockIfEmpty) {\n        const newNode = createElement(\n            KnownCreateElementDataIndex.EmptyLine,\n            regionBase.rootNode.ownerDocument\n        );\n        regionBase.rootNode.appendChild(newNode!);\n\n        const block = getBlockElementAtNode(regionBase.rootNode, newNode);\n\n        if (block) {\n            blocks.push(block);\n        }\n    }\n\n    return blocks;\n}\n"]}