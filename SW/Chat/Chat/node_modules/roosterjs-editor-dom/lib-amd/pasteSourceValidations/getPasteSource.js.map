{"version":3,"file":"getPasteSource.js","sourceRoot":"","sources":["../../../../packages/roosterjs-editor-dom/lib/pasteSourceValidations/getPasteSource.ts"],"names":[],"mappings":";;;IAyBA,IAAM,kBAAkB,GAAG,IAAI,GAAG,CAA0C;QACxE,sBAAmC,+BAAqB,CAAC;QACzD,uBAAoC,gCAAsB,CAAC;QAC3D,sBAAmC,+BAAqB,CAAC;QACzD,4BAAyC,qCAA2B,CAAC;QACrE,wBAAqC,oCAA0B,CAAC;QAChE,uBAAoC,+BAAqB,CAAC;QAC1D,sBAAmC,oCAA0B,CAAC;KACjE,CAAC,CAAC;IAEH;;;;;OAKG;IACH,SAAwB,cAAc,CAClC,KAAuB,EACvB,wBAAiC;QAEzB,IAAA,cAAc,GAA8B,KAAK,eAAnC,EAAE,aAAa,GAAe,KAAK,cAApB,EAAE,QAAQ,GAAK,KAAK,SAAV,CAAW;QAE1D,IAAI,MAAM,GAAgC,IAAI,CAAC;QAC/C,IAAM,KAAK,GAAyB;YAChC,cAAc,gBAAA;YACd,QAAQ,UAAA;YACR,wBAAwB,0BAAA;YACxB,aAAa,eAAA;SAChB,CAAC;QAEF,kBAAkB,CAAC,OAAO,CAAC,UAAC,IAAI,EAAE,GAAG;YACjC,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,KAAK,CAAC,EAAE;gBACxB,MAAM,GAAG,GAAG,CAAC;aAChB;QACL,CAAC,CAAC,CAAC;QAEH,OAAO,MAAM,aAAN,MAAM,cAAN,MAAM,kBAAgC,CAAC;IAClD,CAAC;IArBD,iCAqBC","sourcesContent":["import documentContainWacElements from './documentContainWacElements';\nimport isExcelDesktopDocument from './isExcelDesktopDocument';\nimport isExcelOnlineDocument from './isExcelOnlineDocument';\nimport isGoogleSheetDocument from './isGoogleSheetDocument';\nimport isPowerPointDesktopDocument from './isPowerPointDesktopDocument';\nimport isWordDesktopDocument from './isWordDesktopDocument';\nimport shouldConvertToSingleImage from './shouldConvertToSingleImage';\nimport { KnownPasteSourceType } from 'roosterjs-editor-types';\nimport type { BeforePasteEvent, ClipboardData } from 'roosterjs-editor-types';\n\n/**\n * @internal\n */\nexport type getSourceInputParams = {\n    htmlAttributes: Record<string, string>;\n    fragment: DocumentFragment;\n    shouldConvertSingleImage: boolean;\n    clipboardData: ClipboardData;\n};\n\n/**\n * @internal\n */\nexport type getSourceFunction = (props: getSourceInputParams) => boolean;\n\nconst getSourceFunctions = new Map<KnownPasteSourceType, getSourceFunction>([\n    [KnownPasteSourceType.WordDesktop, isWordDesktopDocument],\n    [KnownPasteSourceType.ExcelDesktop, isExcelDesktopDocument],\n    [KnownPasteSourceType.ExcelOnline, isExcelOnlineDocument],\n    [KnownPasteSourceType.PowerPointDesktop, isPowerPointDesktopDocument],\n    [KnownPasteSourceType.WacComponents, documentContainWacElements],\n    [KnownPasteSourceType.GoogleSheets, isGoogleSheetDocument],\n    [KnownPasteSourceType.SingleImage, shouldConvertToSingleImage],\n]);\n\n/**\n * This function tries to get the source of the Pasted content\n * @param event the before paste event\n * @param shouldConvertSingleImage Whether convert single image is enabled.\n * @returns The Type of pasted content, if no type found will return {KnownSourceType.Default}\n */\nexport default function getPasteSource(\n    event: BeforePasteEvent,\n    shouldConvertSingleImage: boolean\n): KnownPasteSourceType {\n    const { htmlAttributes, clipboardData, fragment } = event;\n\n    let result: KnownPasteSourceType | null = null;\n    const param: getSourceInputParams = {\n        htmlAttributes,\n        fragment,\n        shouldConvertSingleImage,\n        clipboardData,\n    };\n\n    getSourceFunctions.forEach((func, key) => {\n        if (!result && func(param)) {\n            result = key;\n        }\n    });\n\n    return result ?? KnownPasteSourceType.Default;\n}\n"]}