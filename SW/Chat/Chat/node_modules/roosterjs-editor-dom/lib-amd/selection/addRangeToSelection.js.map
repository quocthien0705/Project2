{"version":3,"file":"addRangeToSelection.js","sourceRoot":"","sources":["../../../../packages/roosterjs-editor-dom/lib/selection/addRangeToSelection.ts"],"names":[],"mappings":";;;IAEA;;;;;;OAMG;IACH,SAAwB,mBAAmB,CAAC,KAAY,EAAE,aAAuB;;QAC7E,IAAM,SAAS,GAAG,MAAA,MAAA,MAAA,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,uBAAuB,0CAAE,aAAa,0CAAE,WAAW,0CAAE,YAAY,EAAE,CAAC;QAC7F,IAAI,SAAS,EAAE;YACX,IAAI,YAAY,GAAG,IAAI,CAAC;YAExB,IAAI,SAAS,CAAC,UAAU,GAAG,CAAC,EAAE;gBAC1B,mCAAmC;gBACnC,IAAI;oBACA,IAAI,YAAY,GAAiB,IAAI,CAAC;oBACtC,6EAA6E;oBAC7E,oFAAoF;oBACpF,IACI,CAAC,aAAa,IAAI,iBAAO,CAAC,MAAM,CAAC;wBACjC,CAAC,YAAY,GAAG,SAAS,CAAC,UAAU,IAAI,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;wBAC3E,YAAY,CAAC,cAAc,IAAI,KAAK,CAAC,cAAc;wBACnD,YAAY,CAAC,WAAW,IAAI,KAAK,CAAC,WAAW;wBAC7C,YAAY,CAAC,YAAY,IAAI,KAAK,CAAC,YAAY;wBAC/C,YAAY,CAAC,SAAS,IAAI,KAAK,CAAC,SAAS,EAC3C;wBACE,YAAY,GAAG,KAAK,CAAC;qBACxB;yBAAM;wBACH,SAAS,CAAC,eAAe,EAAE,CAAC;qBAC/B;iBACJ;gBAAC,OAAO,CAAC,EAAE,GAAE;aACjB;YAED,IAAI,YAAY,EAAE;gBACd,SAAS,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;aAC7B;SACJ;IACL,CAAC;IA9BD,sCA8BC","sourcesContent":["import { Browser } from '../utils/Browser';\n\n/**\n * Add the given range into selection of the given document\n * @param range The range to select\n * @param skipSameRange When set to true, do nothing if the given range is the same with current selection,\n * otherwise it will always remove current selection range and set to the given one.\n * This parameter is always treat as true in Edge to avoid some weird runtime exception.\n */\nexport default function addRangeToSelection(range: Range, skipSameRange?: boolean) {\n    const selection = range?.commonAncestorContainer?.ownerDocument?.defaultView?.getSelection();\n    if (selection) {\n        let needAddRange = true;\n\n        if (selection.rangeCount > 0) {\n            // Workaround IE exception 800a025e\n            try {\n                let currentRange: Range | null = null;\n                // Do not remove/add range if current selection is the same with target range\n                // Without this check, execCommand() may fail in Edge since we changed the selection\n                if (\n                    (skipSameRange || Browser.isEdge) &&\n                    (currentRange = selection.rangeCount == 1 ? selection.getRangeAt(0) : null) &&\n                    currentRange.startContainer == range.startContainer &&\n                    currentRange.startOffset == range.startOffset &&\n                    currentRange.endContainer == range.endContainer &&\n                    currentRange.endOffset == range.endOffset\n                ) {\n                    needAddRange = false;\n                } else {\n                    selection.removeAllRanges();\n                }\n            } catch (e) {}\n        }\n\n        if (needAddRange) {\n            selection.addRange(range);\n        }\n    }\n}\n"]}