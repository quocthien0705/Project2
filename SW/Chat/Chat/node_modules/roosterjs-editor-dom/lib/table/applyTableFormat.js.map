{"version":3,"file":"applyTableFormat.js","sourceRoot":"","sources":["../../../../packages/roosterjs-editor-dom/lib/table/applyTableFormat.ts"],"names":[],"mappings":"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","sourcesContent":["import changeElementTag from '../utils/changeElementTag';\nimport setColor from '../utils/setColor';\nimport { getTableCellMetadata } from './tableCellInfo';\nimport { TableBorderFormat } from 'roosterjs-editor-types';\nimport type { DarkColorHandler, TableFormat, VCell } from 'roosterjs-editor-types';\nconst TRANSPARENT = 'transparent';\nconst TABLE_CELL_TAG_NAME = 'TD';\nconst TABLE_HEADER_TAG_NAME = 'TH';\n\n/**\n * @internal\n * Apply the given table format to this virtual table\n * @param format Table format to apply\n * @param darkColorHandler An object to handle dark background colors, if not passed the cell background color will not be set\n */\nexport default function applyTableFormat(\n    table: HTMLTableElement,\n    cells: VCell[][],\n    format: Required<TableFormat>,\n    darkColorHandler?: DarkColorHandler | null\n) {\n    if (!format) {\n        return;\n    }\n    table.style.borderCollapse = 'collapse';\n    setBordersType(cells, format);\n    setCellFormat(cells, format, darkColorHandler);\n    setFirstColumnFormat(cells, format);\n    setHeaderRowFormat(cells, format, darkColorHandler);\n}\n\n/**\n * Check if the cell has shade meta override\n * @param cell\n * @returns\n */\nfunction hasCellShadeOverride(cell: VCell) {\n    if (!cell.td) {\n        return false;\n    }\n\n    return !!getTableCellMetadata(cell.td)?.bgColorOverride;\n}\n\n/**\n * Check if the cell has vertical align meta override\n * @param cell\n * @returns\n */\nfunction hasValignOverride(cell: VCell) {\n    if (!cell.td) {\n        return false;\n    }\n\n    return !!getTableCellMetadata(cell.td)?.vAlignOverride;\n}\n\n/**\n * Check if the cell has any modified border meta override\n * @param cell\n * @returns\n */\nfunction hasBorderOverride(cell: VCell) {\n    if (!cell.td) {\n        return false;\n    }\n\n    return !!getTableCellMetadata(cell.td)?.borderOverride;\n}\n/**\n * Set color and vertical align to the table\n * @param format the format that must be applied\n * @param darkColorHandler An object to handle dark background colors, if not passed the cell background color will not be set\n */\nfunction setCellFormat(\n    cells: VCell[][],\n    format: TableFormat,\n    darkColorHandler?: DarkColorHandler | null\n) {\n    const color = (index: number) => (index % 2 === 0 ? format.bgColorEven : format.bgColorOdd);\n    const { hasBandedRows, hasBandedColumns, bgColorOdd, bgColorEven } = format;\n    const shouldColorWholeTable = !hasBandedRows && bgColorOdd === bgColorEven ? true : false;\n    cells.forEach((row, index) => {\n        row.forEach(cell => {\n            if (cell.td) {\n                // Set cell color\n                if (!hasCellShadeOverride(cell)) {\n                    if (hasBandedRows) {\n                        const backgroundColor = color(index);\n                        setColor(\n                            cell.td,\n                            backgroundColor || TRANSPARENT,\n                            true /** isBackgroundColor*/,\n                            undefined /** isDarkMode **/,\n                            true /** shouldAdaptFontColor */,\n                            darkColorHandler\n                        );\n                    } else if (shouldColorWholeTable) {\n                        setColor(\n                            cell.td,\n                            format.bgColorOdd || TRANSPARENT,\n                            true /** isBackgroundColor*/,\n                            undefined /** isDarkMode **/,\n                            true /** shouldAdaptFontColor */,\n                            darkColorHandler\n                        );\n                    } else {\n                        setColor(\n                            cell.td,\n                            TRANSPARENT,\n                            true /** isBackgroundColor*/,\n                            undefined /** isDarkMode **/,\n                            true /** shouldAdaptFontColor */,\n                            darkColorHandler\n                        );\n                    }\n                }\n                // Set cell vertical align\n                if (format.verticalAlign && !hasValignOverride(cell)) {\n                    cell.td.style.verticalAlign = format.verticalAlign;\n                }\n            }\n        });\n    });\n    if (hasBandedColumns) {\n        cells.forEach(row => {\n            row.forEach((cell, index) => {\n                const backgroundColor = color(index);\n                if (cell.td && backgroundColor && !hasCellShadeOverride(cell)) {\n                    setColor(\n                        cell.td,\n                        backgroundColor,\n                        true /** isBackgroundColor*/,\n                        undefined /** isDarkMode **/,\n                        true /** shouldAdaptFontColor */,\n                        darkColorHandler\n                    );\n                }\n            });\n        });\n    }\n}\n\n/**\n * Set color to borders of an table\n * @param format\n * @returns\n */\nfunction setBorderColors(td: HTMLTableCellElement, format: Partial<TableFormat>) {\n    td.style.borderTop = getBorderStyle(format.topBorderColor);\n    td.style.borderLeft = getBorderStyle(format.verticalBorderColor);\n    td.style.borderRight = getBorderStyle(format.verticalBorderColor);\n    td.style.borderBottom = getBorderStyle(format.bottomBorderColor);\n}\n\n/**\n * Format the border type\n * @returns\n */\nfunction formatBorders(\n    format: TableFormat,\n    td: HTMLTableCellElement,\n    isFirstRow: boolean,\n    isLastRow: boolean,\n    isFirstColumn: boolean,\n    isLastColumn: boolean\n) {\n    setBorderColors(td, format);\n    switch (format.tableBorderFormat) {\n        case TableBorderFormat.DEFAULT:\n            return;\n        case TableBorderFormat.LIST_WITH_SIDE_BORDERS:\n            if (!isFirstColumn) {\n                td.style.borderLeftColor = TRANSPARENT;\n            }\n            if (!isLastColumn) {\n                td.style.borderRightColor = TRANSPARENT;\n            }\n\n            break;\n        case TableBorderFormat.FIRST_COLUMN_HEADER_EXTERNAL:\n            if (!isFirstRow) {\n                td.style.borderTopColor = TRANSPARENT;\n            }\n\n            if (!isLastRow && !isFirstRow) {\n                td.style.borderBottomColor = TRANSPARENT;\n            }\n            if (!isFirstColumn) {\n                td.style.borderLeftColor = TRANSPARENT;\n            }\n            if (!isLastColumn && !isFirstColumn) {\n                td.style.borderRightColor = TRANSPARENT;\n            }\n            if (isFirstColumn && isFirstRow) {\n                td.style.borderRightColor = TRANSPARENT;\n            }\n\n            break;\n        case TableBorderFormat.NO_HEADER_BORDERS:\n            if (isFirstRow) {\n                td.style.borderTopColor = TRANSPARENT;\n                td.style.borderRightColor = TRANSPARENT;\n                td.style.borderLeftColor = TRANSPARENT;\n            }\n            if (isFirstColumn) {\n                td.style.borderLeftColor = TRANSPARENT;\n            }\n            if (isLastColumn) {\n                td.style.borderRightColor = TRANSPARENT;\n            }\n            break;\n        case TableBorderFormat.NO_SIDE_BORDERS:\n            if (isFirstColumn) {\n                td.style.borderLeftColor = TRANSPARENT;\n            }\n            if (isLastColumn) {\n                td.style.borderRightColor = TRANSPARENT;\n            }\n            break;\n        case TableBorderFormat.ESPECIAL_TYPE_1:\n            if (isFirstRow) {\n                td.style.borderRightColor = TRANSPARENT;\n                td.style.borderLeftColor = TRANSPARENT;\n            }\n            if (isFirstColumn) {\n                td.style.borderBottomColor = TRANSPARENT;\n                td.style.borderTopColor = TRANSPARENT;\n            }\n            if (isFirstRow && isFirstColumn) {\n                td.style.borderLeftColor = format.verticalBorderColor || TRANSPARENT;\n                td.style.borderBottomColor = format.bottomBorderColor || TRANSPARENT;\n                td.style.borderTopColor = format.topBorderColor || TRANSPARENT;\n            }\n            break;\n        case TableBorderFormat.ESPECIAL_TYPE_2:\n            if (isFirstRow) {\n                td.style.borderRightColor = TRANSPARENT;\n                td.style.borderLeftColor = TRANSPARENT;\n            }\n            if (isFirstColumn) {\n                td.style.borderBottomColor = TRANSPARENT;\n                td.style.borderTopColor = TRANSPARENT;\n            }\n            if (isFirstRow && isFirstColumn) {\n                td.style.borderLeftColor = format.verticalBorderColor || TRANSPARENT;\n                td.style.borderBottomColor = format.bottomBorderColor || TRANSPARENT;\n                td.style.borderTopColor = format.topBorderColor || TRANSPARENT;\n            }\n            if (!isFirstRow && !isFirstColumn) {\n                td.style.borderLeftColor = TRANSPARENT;\n                td.style.borderBottomColor = TRANSPARENT;\n                td.style.borderTopColor = TRANSPARENT;\n                td.style.borderRightColor = TRANSPARENT;\n            }\n\n            break;\n        case TableBorderFormat.ESPECIAL_TYPE_3:\n            if (isFirstRow) {\n                td.style.borderLeftColor = TRANSPARENT;\n                td.style.borderTopColor = TRANSPARENT;\n                td.style.borderRightColor = TRANSPARENT;\n            }\n            if (isFirstColumn) {\n                td.style.borderLeftColor = TRANSPARENT;\n                td.style.borderTopColor = TRANSPARENT;\n                td.style.borderBottomColor = TRANSPARENT;\n            }\n            if (!isFirstRow && !isFirstColumn) {\n                td.style.borderLeftColor = TRANSPARENT;\n                td.style.borderBottomColor = TRANSPARENT;\n                td.style.borderTopColor = TRANSPARENT;\n                td.style.borderRightColor = TRANSPARENT;\n            }\n            if (isFirstRow && isFirstColumn) {\n                td.style.borderBottomColor = format.bottomBorderColor || TRANSPARENT;\n            }\n            break;\n    }\n}\n\n/**\n * Organize the borders of table according to a border type\n * @param format\n * @returns\n */\nfunction setBordersType(cells: VCell[][], format: TableFormat) {\n    cells.forEach((row, rowIndex) => {\n        row.forEach((cell, cellIndex) => {\n            if (cell.td && !hasBorderOverride(cell)) {\n                formatBorders(\n                    format,\n                    cell.td,\n                    rowIndex === 0,\n                    rowIndex === cells.length - 1,\n                    cellIndex === 0,\n                    cellIndex === row.length - 1\n                );\n            }\n        });\n    });\n}\n\n/**\n * Apply custom design to the first table column\n * @param format\n * @returns\n */\nfunction setFirstColumnFormat(cells: VCell[][], format: Partial<TableFormat>) {\n    if (!format.hasFirstColumn) {\n        cells.forEach(row => {\n            row.forEach((cell, cellIndex) => {\n                if (cell.td && cellIndex === 0) {\n                    cell.td = changeElementTag(\n                        cell.td,\n                        TABLE_CELL_TAG_NAME\n                    ) as HTMLTableCellElement;\n                    cell.td.scope = '';\n                }\n            });\n        });\n        return;\n    }\n    cells.forEach((row, rowIndex) => {\n        row.forEach((cell, cellIndex) => {\n            if (cell.td && cellIndex === 0) {\n                if (rowIndex !== 0 && !hasCellShadeOverride(cell)) {\n                    cell.td.style.borderTopColor = TRANSPARENT;\n                    setColor(\n                        cell.td,\n                        TRANSPARENT,\n                        true /** isBackgroundColor*/,\n                        undefined /** isDarkMode **/,\n                        true /** shouldAdaptFontColor */\n                    );\n                }\n                if (rowIndex !== cells.length - 1 && rowIndex !== 0) {\n                    cell.td.style.borderBottomColor = TRANSPARENT;\n                }\n                cell.td = changeElementTag(cell.td, TABLE_HEADER_TAG_NAME) as HTMLTableCellElement;\n                cell.td.scope = 'col';\n            }\n        });\n    });\n}\n\n/**\n * Apply custom design to the Header Row\n * @param format\n * @param darkColorHandler An object to handle dark background colors, if not passed the cell background color will not be set\n * @returns\n */\nfunction setHeaderRowFormat(\n    cells: VCell[][],\n    format: TableFormat,\n    darkColorHandler?: DarkColorHandler | null\n) {\n    if (!format.hasHeaderRow) {\n        cells[0]?.forEach(cell => {\n            if (cell.td) {\n                cell.td = changeElementTag(cell.td, TABLE_CELL_TAG_NAME) as HTMLTableCellElement;\n                cell.td.scope = '';\n            }\n        });\n        return;\n    }\n    cells[0]?.forEach(cell => {\n        if (cell.td && format.headerRowColor) {\n            if (!hasCellShadeOverride(cell)) {\n                setColor(\n                    cell.td,\n                    format.headerRowColor,\n                    true /** isBackgroundColor*/,\n                    undefined /** isDarkMode **/,\n                    true /** shouldAdaptFontColor */,\n                    darkColorHandler\n                );\n            }\n            cell.td.style.borderRightColor = format.headerRowColor;\n            cell.td.style.borderLeftColor = format.headerRowColor;\n            cell.td.style.borderTopColor = format.headerRowColor;\n            cell.td = changeElementTag(cell.td, TABLE_HEADER_TAG_NAME) as HTMLTableCellElement;\n            cell.td.scope = 'row';\n        }\n    });\n}\n\nfunction getBorderStyle(style?: string | null) {\n    const color = style ? style : 'transparent';\n    return 'solid 1px ' + color;\n}\n"]}