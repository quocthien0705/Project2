{"version":3,"sources":["../../../../../../packages/react-chat/src/components/ChatMessage/useChatMessage.ts"],"sourcesContent":["import * as React from 'react';\nimport {\n  getPartitionedNativeProps,\n  resolveShorthand,\n} from '@fluentui/react-components';\nimport type { ChatMessageProps, ChatMessageState } from './ChatMessage.types';\nimport { getDecorationIcon } from '../utils/getDecorationIcon';\nimport { useChatMessageFocusableGroup } from '../utils/useChatMessageFocusableGroup';\nimport { useChatMessagePopoverTrigger } from '../utils/useChatMessagePopoverTrigger';\n\n/**\n * Create the state required to render ChatMessage.\n *\n * The returned state can be modified with hooks such as useChatMessageStyles_unstable,\n * before being passed to renderChatMessage_unstable.\n *\n * @param props - props from this instance of ChatMessage\n * @param ref - reference to root HTMLElement of ChatMessage\n */\nexport const useChatMessage_unstable = (\n  props: ChatMessageProps,\n  ref: React.Ref<HTMLDivElement>\n): ChatMessageState => {\n  const {\n    attached,\n    author,\n    avatar,\n    body,\n    decoration,\n    decorationIcon,\n    decorationLabel,\n    details,\n    persistentTimestamp,\n    reactions,\n    root,\n    showAnimation,\n    timestamp,\n  } = props;\n\n  /**\n   * Splits the native props into ones that go to the `root` slot, and ones that go to the primary slot.\n   * The primary slot is the `body` slot in this case.\n   */\n  const nativeProps = getPartitionedNativeProps<\n    ChatMessageProps &\n      Pick<\n        React.HTMLAttributes<HTMLElement>,\n        'style' | 'className' | 'tabIndex'\n      >,\n    'tabIndex'\n  >({\n    primarySlotTagName: 'div',\n    props,\n    excludedPropNames: ['tabIndex'], // tabIndex from props will not be applied to the primary slot, as it should always be 0 for tabster navigation\n  });\n\n  const state: ChatMessageState = {\n    attached,\n    decoration,\n    persistentTimestamp,\n    showAnimation,\n\n    body: resolveShorthand(body, {\n      required: true,\n      defaultProps: {\n        ref,\n        ...nativeProps.primary,\n        tabIndex: 0,\n      },\n    }),\n    root: resolveShorthand(root, {\n      required: true,\n      defaultProps: nativeProps.root,\n    }),\n\n    author: resolveShorthand(author),\n    avatar:\n      attached && attached !== 'top' ? undefined : resolveShorthand(avatar),\n    decorationIcon: resolveShorthand(decorationIcon, {\n      required: !!decoration,\n    }),\n    decorationLabel: resolveShorthand(decorationLabel),\n    details: resolveShorthand(details),\n    reactions: resolveShorthand(reactions),\n    timestamp: resolveShorthand(timestamp),\n\n    components: {\n      author: 'div',\n      avatar: 'div',\n      body: 'div',\n      decorationIcon: 'div',\n      decorationLabel: 'div',\n      details: 'div',\n      reactions: 'div',\n      root: 'div',\n      timestamp: 'span',\n    },\n  };\n\n  if (state.decorationIcon && !state.decorationIcon.children) {\n    state.decorationIcon.children = getDecorationIcon(decoration);\n  }\n\n  useChatMessagePopoverTrigger(state);\n  useChatMessageFocusableGroup(state);\n\n  return state;\n};\n"],"names":["useChatMessage_unstable","props","ref","attached","author","avatar","body","decoration","decorationIcon","decorationLabel","details","persistentTimestamp","reactions","root","showAnimation","timestamp","nativeProps","getPartitionedNativeProps","primarySlotTagName","excludedPropNames","state","resolveShorthand","required","defaultProps","primary","tabIndex","undefined","components","children","getDecorationIcon","useChatMessagePopoverTrigger","useChatMessageFocusableGroup"],"mappings":";;;;+BAmBaA;;;eAAAA;;;;iEAnBU;iCAIhB;mCAE2B;8CACW;8CACA;AAWtC,MAAMA,0BAA0B,CACrCC,OACAC,MACqB;IACrB,MAAM,EACJC,SAAQ,EACRC,OAAM,EACNC,OAAM,EACNC,KAAI,EACJC,WAAU,EACVC,eAAc,EACdC,gBAAe,EACfC,QAAO,EACPC,oBAAmB,EACnBC,UAAS,EACTC,KAAI,EACJC,cAAa,EACbC,UAAS,EACV,GAAGd;IAEJ;;;GAGC,GACD,MAAMe,cAAcC,IAAAA,0CAAyB,EAO3C;QACAC,oBAAoB;QACpBjB;QACAkB,mBAAmB;YAAC;SAAW;IACjC;IAEA,MAAMC,QAA0B;QAC9BjB;QACAI;QACAI;QACAG;QAEAR,MAAMe,IAAAA,iCAAgB,EAACf,MAAM;YAC3BgB,UAAU,IAAI;YACdC,cAAc;gBACZrB;gBACA,GAAGc,YAAYQ,OAAO;gBACtBC,UAAU;YACZ;QACF;QACAZ,MAAMQ,IAAAA,iCAAgB,EAACR,MAAM;YAC3BS,UAAU,IAAI;YACdC,cAAcP,YAAYH,IAAI;QAChC;QAEAT,QAAQiB,IAAAA,iCAAgB,EAACjB;QACzBC,QACEF,YAAYA,aAAa,QAAQuB,YAAYL,IAAAA,iCAAgB,EAAChB,OAAO;QACvEG,gBAAgBa,IAAAA,iCAAgB,EAACb,gBAAgB;YAC/Cc,UAAU,CAAC,CAACf;QACd;QACAE,iBAAiBY,IAAAA,iCAAgB,EAACZ;QAClCC,SAASW,IAAAA,iCAAgB,EAACX;QAC1BE,WAAWS,IAAAA,iCAAgB,EAACT;QAC5BG,WAAWM,IAAAA,iCAAgB,EAACN;QAE5BY,YAAY;YACVvB,QAAQ;YACRC,QAAQ;YACRC,MAAM;YACNE,gBAAgB;YAChBC,iBAAiB;YACjBC,SAAS;YACTE,WAAW;YACXC,MAAM;YACNE,WAAW;QACb;IACF;IAEA,IAAIK,MAAMZ,cAAc,IAAI,CAACY,MAAMZ,cAAc,CAACoB,QAAQ,EAAE;QAC1DR,MAAMZ,cAAc,CAACoB,QAAQ,GAAGC,IAAAA,oCAAiB,EAACtB;IACpD,CAAC;IAEDuB,IAAAA,0DAA4B,EAACV;IAC7BW,IAAAA,0DAA4B,EAACX;IAE7B,OAAOA;AACT"}