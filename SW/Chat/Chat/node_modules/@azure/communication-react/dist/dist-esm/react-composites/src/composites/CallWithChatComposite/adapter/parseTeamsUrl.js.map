{"version":3,"file":"parseTeamsUrl.js","sourceRoot":"","sources":["../../../../../../../preprocess-dist/react-composites/src/composites/CallWithChatComposite/adapter/parseTeamsUrl.ts"],"names":[],"mappings":"AAAA,uCAAuC;AACvC,kCAAkC;AAElC,OAAO,EAAE,4BAA4B,EAAE,2BAA2B,EAAE,MAAM,wBAAwB,CAAC;AACnG;;;;;GAKG;AACH,MAAM,CAAC,MAAM,0BAA0B,GAAG,CAAC,gBAAwB,EAAU,EAAE;IAC7E,oHAAoH;IACpH,IAAI,QAAQ,GAAG,gBAAgB,CAAC,OAAO,CAAC,4CAA4C,EAAE,EAAE,CAAC,CAAC;IAC1F,yFAAyF;IACzF,QAAQ,GAAG,kBAAkB,CAAC,QAAQ,CAAC,CAAC;IACxC,+EAA+E;IAC/E,QAAQ,GAAG,QAAQ,CAAC,KAAK,CAAC,qBAAqB,CAAC,CAAC,CAAC,CAAC,CAAC;IACpD,IAAI,CAAC,QAAQ,IAAI,QAAQ,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;QACvC,IAAI,4BAA4B,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;YACzE,MAAM,IAAI,KAAK,CAAC,iEAAiE,2BAA2B,EAAE,CAAC,CAAC;QAClH,CAAC;QACD,MAAM,IAAI,KAAK,CAAC,2CAA2C,CAAC,CAAC;IAC/D,CAAC;IACD,OAAO,QAAQ,CAAC;AAClB,CAAC,CAAC","sourcesContent":["// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT License.\n\nimport { UNSUPPORTED_CHAT_THREAD_TYPE, TEAMS_LIMITATION_LEARN_MORE } from '../../common/constants';\n/**\n * Get chat thread from a teams url.\n * As per documented on the Chat SDK: https://docs.microsoft.com/en-us/azure/communication-services/quickstarts/chat/meeting-interop?pivots=platform-web#get-a-teams-meeting-chat-thread-for-a-communication-services-user\n *\n * @private\n */\nexport const getChatThreadFromTeamsLink = (teamsMeetingLink: string): string => {\n  // Get the threadId from the url - this also contains the call locator ID that will be removed in the threadId.split\n  let threadId = teamsMeetingLink.replace('https://teams.microsoft.com/l/meetup-join/', '');\n  // Unescape characters that applications like Outlook encode when creating joinable links\n  threadId = decodeURIComponent(threadId);\n  // Extract just the chat guid from the link, stripping away the call locator ID\n  threadId = threadId.split(/^(.*?@thread\\.v2)/gm)[1];\n  if (!threadId || threadId.length === 0) {\n    if (UNSUPPORTED_CHAT_THREAD_TYPE.some(t => teamsMeetingLink.includes(t))) {\n      throw new Error(`Teams Channel Meetings are not currently supported, read more ${TEAMS_LIMITATION_LEARN_MORE}`);\n    }\n    throw new Error('Could not get chat thread from teams link');\n  }\n  return threadId;\n};"]}