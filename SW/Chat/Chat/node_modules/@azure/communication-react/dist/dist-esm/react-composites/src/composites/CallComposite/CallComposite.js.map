{"version":3,"file":"CallComposite.js","sourceRoot":"","sources":["../../../../../../preprocess-dist/react-composites/src/composites/CallComposite/CallComposite.tsx"],"names":[],"mappings":"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","sourcesContent":["// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT License.\n\nimport { _isInCall } from '@internal/calling-component-bindings';\nimport { ActiveErrorMessage, ErrorBar, ParticipantMenuItemsCallback, useTheme } from '@internal/react-components';\nimport React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { AvatarPersonaDataCallback } from '../common/AvatarPersona';\nimport { BaseProvider, BaseCompositeProps } from '../common/BaseComposite';\nimport { CallCompositeIcons } from '../common/icons';\nimport { useLocale } from '../localization';\nimport { CommonCallAdapter, StartCallIdentifier } from './adapter/CallAdapter';\nimport { CallAdapterProvider, useAdapter } from './adapter/CallAdapterProvider';\nimport { CallPage } from './pages/CallPage';\nimport { ConfigurationPage } from './pages/ConfigurationPage';\nimport { NoticePage } from './pages/NoticePage';\nimport { useSelector } from './hooks/useSelector';\nimport { getEndedCall, getPage, getTargetCallees } from './selectors/baseSelectors';\nimport { LobbyPage } from './pages/LobbyPage';\n/* @conditional-compile-remove(call-transfer) */\nimport { TransferPage } from './pages/TransferPage';\nimport { leavingPageStyle, mainScreenContainerStyleDesktop, mainScreenContainerStyleMobile } from './styles/CallComposite.styles';\nimport { CallControlOptions } from './types/CallControlOptions';\nimport { LayerHost, mergeStyles } from '@fluentui/react';\nimport { modalLayerHostStyle } from '../common/styles/ModalLocalAndRemotePIP.styles';\nimport { useId } from '@fluentui/react-hooks';\nimport { PermissionConstraints } from '@azure/communication-calling';\n/* @conditional-compile-remove(rooms) */\nimport { ParticipantRole } from '@azure/communication-calling';\nimport { MobileChatSidePaneTabHeaderProps } from '../common/TabHeader';\nimport { InjectedSidePaneProps, SidePaneProvider, SidePaneRenderer } from './components/SidePane/SidePaneProvider';\nimport { filterLatestErrors, getEndedCallPageProps, trackErrorAsDismissed, updateTrackedErrorsWithActiveErrors } from './utils';\nimport { TrackedErrors } from './types/ErrorTracking';\nimport { usePropsFor } from './hooks/usePropsFor';\nimport { deviceCountSelector } from './selectors/deviceCountSelector';\nimport { VideoGalleryLayout } from '@internal/react-components';\n/* @conditional-compile-remove(capabilities) */\nimport { capabilitiesChangedInfoAndRoleSelector } from './selectors/capabilitiesChangedInfoAndRoleSelector';\n/* @conditional-compile-remove(capabilities) */\nimport { useTrackedCapabilityChangedNotifications } from './utils/TrackCapabilityChangedNotifications';\nimport { useEndedCallConsoleErrors } from './utils/useConsoleErrors';\n/**\n * Props for {@link CallComposite}.\n *\n * @public\n */\nexport interface CallCompositeProps extends BaseCompositeProps<CallCompositeIcons> {\n  /**\n   * An adapter provides logic and data to the composite.\n   * Composite can also be controlled using the adapter.\n   */\n  adapter: CommonCallAdapter;\n  /**\n   * Optimizes the composite form factor for either desktop or mobile.\n   * @remarks `mobile` is currently only optimized for Portrait mode on mobile devices and does not support landscape.\n   * @defaultValue 'desktop'\n   */\n  formFactor?: 'desktop' | 'mobile';\n  /**\n   * URL to invite new participants to the current call. If this is supplied, a button appears in the Participants\n   * Button flyout menu.\n   */\n  callInvitationUrl?: string;\n  /**\n   * Flags to enable/disable or customize UI elements of the {@link CallComposite}.\n   */\n  options?: CallCompositeOptions;\n}\n/**\n * Menu options for remote video tiles in {@link VideoGallery}.\n *\n * @public\n */\nexport interface RemoteVideoTileMenuOptions {\n  /**\n   * If set to true, remote video tiles in the VideoGallery will not have menu options\n   *\n   * @defaultValue false\n   */\n  isHidden?: boolean;\n}\n\n/* @conditional-compile-remove(click-to-call) */ /* @conditional-compile-remove(rooms) */ /* @conditional-compile-remove(vertical-gallery) */\n/**\n * Options for the local video tile in the Call composite.\n *\n * @public\n */\nexport interface LocalVideoTileOptions {\n  /**\n   * Position of the local video tile. If unset will render the local tile in the floating local position.\n   *\n   * @defaultValue 'floating'\n   * @remarks 'grid' - local video tile will be rendered in the grid view of the videoGallery.\n   * 'floating' - local video tile will be rendered in the floating position and will observe overflow gallery\n   * local video tile rules and be docked in the bottom corner.\n   * This does not affect the Configuration screen or the side pane Picture in Picture in Picture view.\n   */\n  position?: 'grid' | 'floating';\n}\n/**\n * Optional features of the {@link CallComposite}.\n *\n * @public\n */\nexport type CallCompositeOptions = {\n  /**\n   * Surface Azure Communication Services backend errors in the UI with {@link @azure/communication-react#ErrorBar}.\n   * Hide or show the error bar.\n   * @defaultValue true\n   */\n  errorBar?: boolean;\n  /**\n   * Hide or Customize the control bar element.\n   * Can be customized by providing an object of type {@link @azure/communication-react#CallControlOptions}.\n   * @defaultValue true\n   */\n  callControls?: boolean | CallControlOptions;\n  /**\n   * Remote participant video tile menu options\n   */\n  remoteVideoTileMenuOptions?: RemoteVideoTileMenuOptions;\n  /* @conditional-compile-remove(click-to-call) */\n  /**\n   * Options for controlling the local video tile.\n   *\n   * @remarks if 'false' the local video tile will not be rendered.\n   */\n  localVideoTile?: boolean | LocalVideoTileOptions;\n  /**\n   * Options for controlling the starting layout of the composite's video gallery\n   */\n  galleryOptions?: {\n    /**\n     * Layout for the gallery when the call starts\n     */\n    layout?: VideoGalleryLayout;\n  };\n  /* @conditional-compile-remove(custom-branding) */\n  /**\n   * Options for setting additional customizations related to personalized branding.\n   */\n  branding?: {\n    /**\n     * Logo displayed on the configuration page.\n     */\n    logo?: {\n      /**\n       * URL for the logo image.\n       *\n       * @remarks\n       * Recommended size is 80x80 pixels.\n       */\n      url: string;\n      /**\n       * Alt text for the logo image.\n       */\n      alt?: string;\n      /**\n       * The logo can be displayed as a circle.\n       *\n       * @defaultValue 'unset'\n       */\n      shape?: 'unset' | 'circle';\n    };\n    /* @conditional-compile-remove(custom-branding) */\n    /**\n     * Background image displayed on the configuration page.\n     */\n    backgroundImage?: {\n      /**\n       * URL for the background image.\n       *\n       * @remarks\n       * Background image should be larger than 576x567 pixels and smaller than 2048x2048 pixels pixels.\n       */\n      url: string;\n    };\n  };\n};\ntype MainScreenProps = {\n  mobileView: boolean;\n  modalLayerHostId: string;\n  callInvitationUrl?: string;\n  onFetchAvatarPersonaData?: AvatarPersonaDataCallback;\n  onFetchParticipantMenuItems?: ParticipantMenuItemsCallback;\n  options?: CallCompositeOptions;\n  overrideSidePane?: InjectedSidePaneProps;\n  onSidePaneIdChange?: (sidePaneId: string | undefined) => void;\n  mobileChatTabHeader?: MobileChatSidePaneTabHeaderProps;\n  onCloseChatPane?: () => void;\n};\nconst isShowing = (overrideSidePane?: InjectedSidePaneProps): boolean => {\n  return !!overrideSidePane?.isActive;\n};\nconst MainScreen = (props: MainScreenProps): JSX.Element => {\n  const adapter = useAdapter();\n  const {\n    camerasCount,\n    microphonesCount\n  } = useSelector(deviceCountSelector);\n  const hasCameras = camerasCount > 0;\n  const hasMicrophones = microphonesCount > 0;\n  useEffect(() => {\n    (async () => {\n      const constrain = getQueryOptions({\n        /* @conditional-compile-remove(rooms) */role: adapter.getState().call?.role\n      });\n      await adapter.askDevicePermission(constrain);\n      adapter.queryCameras();\n      adapter.queryMicrophones();\n      adapter.querySpeakers();\n    })();\n  }, [adapter,\n  // Ensure we re-ask for permissions if the number of devices goes from 0 -> n during a call\n  // as we cannot request permissions when there are no devices.\n  hasCameras, hasMicrophones]);\n  const {\n    callInvitationUrl,\n    onFetchAvatarPersonaData,\n    onFetchParticipantMenuItems\n  } = props;\n  const page = useSelector(getPage);\n  const endedCall = useSelector(getEndedCall);\n  const [sidePaneRenderer, setSidePaneRenderer] = React.useState<SidePaneRenderer | undefined>();\n  const [injectedSidePaneProps, setInjectedSidePaneProps] = React.useState<InjectedSidePaneProps>();\n  const [userSetGalleryLayout, setUserSetGalleryLayout] = useState<VideoGalleryLayout>(props.options?.galleryOptions?.layout ?? 'floatingLocalVideo');\n  const [userSetOverflowGalleryPosition, setUserSetOverflowGalleryPosition] = useState<'Responsive' | 'horizontalTop'>('Responsive');\n  const overridePropsRef = useRef<InjectedSidePaneProps | undefined>(props.overrideSidePane);\n  useEffect(() => {\n    setInjectedSidePaneProps(props.overrideSidePane);\n    // When the injected side pane is opened, clear the previous side pane active state.\n    // this ensures when the injected side pane is \"closed\", the previous side pane is not \"re-opened\".\n    if (!isShowing(overridePropsRef.current) && isShowing(props.overrideSidePane)) {\n      setSidePaneRenderer(undefined);\n    }\n    overridePropsRef.current = props.overrideSidePane;\n  }, [props.overrideSidePane]);\n  const onSidePaneIdChange = props.onSidePaneIdChange;\n  useEffect(() => {\n    onSidePaneIdChange?.(sidePaneRenderer?.id);\n  }, [sidePaneRenderer?.id, onSidePaneIdChange]);\n\n  // When the call ends ensure the side pane is set to closed to prevent the side pane being open if the call is re-joined.\n  useEffect(() => {\n    const closeSidePane = (): void => {\n      setSidePaneRenderer(undefined);\n    };\n    adapter.on('callEnded', closeSidePane);\n    return () => {\n      adapter.off('callEnded', closeSidePane);\n    };\n  }, [adapter]);\n\n  /* @conditional-compile-remove(capabilities) */\n  const capabilitiesChangedInfoAndRole = useSelector(capabilitiesChangedInfoAndRoleSelector);\n\n  /* @conditional-compile-remove(capabilities) */\n  const capabilitiesChangedNotificationBarProps = useTrackedCapabilityChangedNotifications(capabilitiesChangedInfoAndRole);\n\n  // Track the last dismissed errors of any error kind to prevent errors from re-appearing on subsequent page navigation\n  // This works by tracking the most recent timestamp of any active error type.\n  // And then tracking when that error type was last dismissed.\n  const activeErrors = usePropsFor(ErrorBar).activeErrorMessages;\n  const [trackedErrors, setTrackedErrors] = useState<TrackedErrors>(({} as TrackedErrors));\n  useEffect(() => {\n    setTrackedErrors(prev => updateTrackedErrorsWithActiveErrors(prev, activeErrors));\n  }, [activeErrors]);\n  const onDismissError = useCallback((error: ActiveErrorMessage) => {\n    setTrackedErrors(prev => trackErrorAsDismissed(error.type, prev));\n  }, []);\n  const latestErrors = useMemo(() => filterLatestErrors(activeErrors, trackedErrors), [activeErrors, trackedErrors]);\n  const callees = (useSelector(getTargetCallees) as StartCallIdentifier[]);\n  const locale = useLocale();\n  const palette = useTheme().palette;\n  const leavePageStyle = useMemo(() => leavingPageStyle(palette), [palette]);\n  let pageElement: JSX.Element | undefined;\n  switch (page) {\n    case 'configuration':\n      pageElement = <ConfigurationPage mobileView={props.mobileView} startCallHandler={(): void => {\n        if (callees) {\n          adapter.startCall(callees);\n        } else {\n          adapter.joinCall({\n            microphoneOn: 'keep',\n            cameraOn: 'keep'\n          });\n        }\n      }} updateSidePaneRenderer={setSidePaneRenderer} latestErrors={latestErrors} onDismissError={onDismissError} modalLayerHostId={props.modalLayerHostId} /* @conditional-compile-remove(capabilities) */\n      capabilitiesChangedNotificationBarProps={capabilitiesChangedNotificationBarProps}\n      /* @conditional-compile-remove(custom-branding) */ logo={props.options?.branding?.logo}\n      /* @conditional-compile-remove(custom-branding) */ backgroundImage={props.options?.branding?.backgroundImage} />;\n      break;\n    case 'accessDeniedTeamsMeeting':\n      pageElement = <NoticePage iconName=\"NoticePageAccessDeniedTeamsMeeting\" title={locale.strings.call.failedToJoinTeamsMeetingReasonAccessDeniedTitle} moreDetails={locale.strings.call.failedToJoinTeamsMeetingReasonAccessDeniedMoreDetails} dataUiId={'access-denied-teams-meeting-page'} />;\n      break;\n    case 'removedFromCall':\n      pageElement = <NoticePage iconName=\"NoticePageRemovedFromCall\" title={locale.strings.call.removedFromCallTitle} moreDetails={locale.strings.call.removedFromCallMoreDetails} dataUiId={'removed-from-call-page'} />;\n      break;\n    case 'joinCallFailedDueToNoNetwork':\n      pageElement = <NoticePage iconName=\"NoticePageJoinCallFailedDueToNoNetwork\" title={locale.strings.call.failedToJoinCallDueToNoNetworkTitle} moreDetails={locale.strings.call.failedToJoinCallDueToNoNetworkMoreDetails} dataUiId={'join-call-failed-due-to-no-network-page'} />;\n      break;\n    case 'leaving':\n      pageElement = <NoticePage title={locale.strings.call.leavingCallTitle ?? 'Leaving...'} dataUiId={'leaving-page'} pageStyle={leavePageStyle} disableStartCallButton={true} />;\n      break;\n    case 'leftCall':\n      {\n        const {\n          title,\n          moreDetails,\n          disableStartCallButton,\n          iconName\n        } = getEndedCallPageProps(locale, endedCall);\n        pageElement = <NoticePage iconName={iconName} title={title} moreDetails={callees ? '' : moreDetails} dataUiId={'left-call-page'} disableStartCallButton={disableStartCallButton} />;\n        break;\n      }\n    case 'lobby':\n      pageElement = <LobbyPage mobileView={props.mobileView} modalLayerHostId={props.modalLayerHostId} options={props.options} updateSidePaneRenderer={setSidePaneRenderer} mobileChatTabHeader={props.mobileChatTabHeader} latestErrors={latestErrors} onDismissError={onDismissError}\n      /* @conditional-compile-remove(capabilities) */ capabilitiesChangedNotificationBarProps={capabilitiesChangedNotificationBarProps} />;\n      break;\n    /* @conditional-compile-remove(call-transfer) */\n    case 'transferring':\n      pageElement = <TransferPage mobileView={props.mobileView} modalLayerHostId={props.modalLayerHostId} options={props.options} updateSidePaneRenderer={setSidePaneRenderer} mobileChatTabHeader={props.mobileChatTabHeader} onFetchAvatarPersonaData={onFetchAvatarPersonaData} latestErrors={latestErrors} onDismissError={onDismissError}\n      /* @conditional-compile-remove(capabilities) */ capabilitiesChangedNotificationBarProps={capabilitiesChangedNotificationBarProps} />;\n      break;\n    case 'call':\n      pageElement = <CallPage callInvitationURL={callInvitationUrl} onFetchAvatarPersonaData={onFetchAvatarPersonaData} onFetchParticipantMenuItems={onFetchParticipantMenuItems} mobileView={props.mobileView} modalLayerHostId={props.modalLayerHostId} options={props.options} updateSidePaneRenderer={setSidePaneRenderer} mobileChatTabHeader={props.mobileChatTabHeader} onCloseChatPane={props.onCloseChatPane} latestErrors={latestErrors} onDismissError={onDismissError} galleryLayout={userSetGalleryLayout} onUserSetGalleryLayoutChange={setUserSetGalleryLayout} onSetUserSetOverflowGalleryPosition={setUserSetOverflowGalleryPosition} userSetOverflowGalleryPosition={userSetOverflowGalleryPosition}\n      /* @conditional-compile-remove(capabilities) */ capabilitiesChangedNotificationBarProps={capabilitiesChangedNotificationBarProps} />;\n      break;\n  }\n  useEndedCallConsoleErrors(endedCall);\n  if (!pageElement) {\n    throw new Error('Invalid call composite page');\n  }\n  return <SidePaneProvider sidePaneRenderer={sidePaneRenderer} overrideSidePane={injectedSidePaneProps}>\n      {pageElement}\n    </SidePaneProvider>;\n};\n\n/**\n * A customizable UI composite for calling experience.\n *\n * @remarks Call composite min width/height are as follow:\n * - mobile: 17.5rem x 21rem (280px x 336px, with default rem at 16px)\n * - desktop: 30rem x 22rem (480px x 352px, with default rem at 16px)\n *\n * @public\n */\nexport const CallComposite = (props: CallCompositeProps): JSX.Element => <CallCompositeInner {...props} />;\n\n/**\n * @private\n */\nexport interface InternalCallCompositeProps {\n  overrideSidePane?: InjectedSidePaneProps;\n  onSidePaneIdChange?: (sidePaneId: string | undefined) => void;\n  onCloseChatPane?: () => void;\n  // legacy property to avoid breaking change\n  mobileChatTabHeader?: MobileChatSidePaneTabHeaderProps;\n}\n\n/** @private */\nexport const CallCompositeInner = (props: CallCompositeProps & InternalCallCompositeProps): JSX.Element => {\n  const {\n    adapter,\n    callInvitationUrl,\n    onFetchAvatarPersonaData,\n    onFetchParticipantMenuItems,\n    options,\n    formFactor = 'desktop'\n  } = props;\n  const mobileView = formFactor === 'mobile';\n  const modalLayerHostId = useId('modalLayerhost');\n  const mainScreenContainerClassName = useMemo(() => {\n    return mobileView ? mainScreenContainerStyleMobile : mainScreenContainerStyleDesktop;\n  }, [mobileView]);\n  return <div className={mainScreenContainerClassName}>\n      <BaseProvider {...props}>\n        <CallAdapterProvider adapter={adapter}>\n          <MainScreen callInvitationUrl={callInvitationUrl} onFetchAvatarPersonaData={onFetchAvatarPersonaData} onFetchParticipantMenuItems={onFetchParticipantMenuItems} mobileView={mobileView} modalLayerHostId={modalLayerHostId} options={options} onSidePaneIdChange={props.onSidePaneIdChange} overrideSidePane={props.overrideSidePane} mobileChatTabHeader={props.mobileChatTabHeader} onCloseChatPane={props.onCloseChatPane} />\n          {\n        // This layer host is for ModalLocalAndRemotePIP in SidePane. This LayerHost cannot be inside the SidePane\n        // because when the SidePane is hidden, ie. style property display is 'none', it takes up no space. This causes problems when dragging\n        // the Modal because the draggable bounds thinks it has no space and will always return to its initial position after dragging.\n        // Additionally, this layer host cannot be in the Call Arrangement as it needs to be rendered before useMinMaxDragPosition() in\n        // common/utils useRef is called.\n        // Warning: this is fragile and works because the call arrangement page is only rendered after the call has connected and thus this\n        // LayerHost will be guaranteed to have rendered (and subsequently mounted in the DOM). This ensures the DOM element will be available\n        // before the call to `document.getElementById(modalLayerHostId)` is made.\n        <LayerHost id={modalLayerHostId} className={mergeStyles(modalLayerHostStyle)} />}\n        </CallAdapterProvider>\n      </BaseProvider>\n    </div>;\n};\nconst getQueryOptions = (options: {\n  /* @conditional-compile-remove(rooms) */role?: ParticipantRole;\n}): PermissionConstraints => {\n  /* @conditional-compile-remove(rooms) */\n  if (options.role === 'Consumer') {\n    return {\n      video: false,\n      audio: true\n    };\n  }\n  return {\n    video: true,\n    audio: true\n  };\n};"]}