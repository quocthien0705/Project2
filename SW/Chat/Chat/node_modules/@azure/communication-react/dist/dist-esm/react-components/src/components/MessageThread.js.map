{"version":3,"file":"MessageThread.js","sourceRoot":"","sources":["../../../../../preprocess-dist/react-components/src/components/MessageThread.tsx"],"names":[],"mappings":"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","sourcesContent":["// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT License.\n\nimport React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { Icon, IStyle, mergeStyles, PrimaryButton } from '@fluentui/react';\nimport { Chat } from '@fluentui-contrib/react-chat';\nimport { mergeClasses } from '@fluentui/react-components';\nimport { DownIconStyle, newMessageButtonContainerStyle, messageThreadContainerStyle, messageThreadWrapperContainerStyle, useChatStyles, buttonWithIconStyles, newMessageButtonStyle } from './styles/MessageThread.styles';\nimport { delay } from './utils/delay';\nimport { BaseCustomStyles, ChatMessage, CustomMessage, SystemMessage, OnRenderAvatarCallback, Message, ReadReceiptsBySenderId, ComponentSlotStyle } from '../types';\nimport { MessageStatusIndicatorProps } from './MessageStatusIndicator';\nimport { memoizeFnAll, MessageStatus } from '@internal/acs-ui-common';\nimport { useLocale } from '../localization/LocalizationProvider';\nimport { isNarrowWidth, _useContainerWidth } from './utils/responsive';\nimport getParticipantsWhoHaveReadMessage from './utils/getParticipantsWhoHaveReadMessage';\nimport { useTheme } from '../theming';\nimport { FluentV9ThemeProvider } from './../theming/FluentV9ThemeProvider';\nimport LiveAnnouncer from './Announcer/LiveAnnouncer';\nimport { createStyleFromV8Style } from './styles/v8StyleShim';\nimport { ChatMessageComponentWrapper, ChatMessageComponentWrapperProps } from './ChatMessage/ChatMessageComponentWrapper';\n/* @conditional-compile-remove(image-overlay) */\nimport { InlineImageOptions } from './ChatMessage/ChatMessageContent';\nimport { MessageStatusIndicatorInternal } from './MessageStatusIndicatorInternal';\nimport { Announcer } from './Announcer';\nconst isMessageSame = (first: ChatMessage, second: ChatMessage): boolean => {\n  return first.messageId === second.messageId && first.content === second.content && first.contentType === second.contentType && JSON.stringify(first.createdOn) === JSON.stringify(second.createdOn) && first.senderId === second.senderId && first.senderDisplayName === second.senderDisplayName && JSON.stringify(first.editedOn) === JSON.stringify(second.editedOn);\n};\n\n/**\n * Get the latest message from the message array.\n *\n * @param messages\n */\nconst getLatestChatMessage = (messages: Message[]): ChatMessage | undefined => {\n  for (let i = messages.length - 1; i >= 0; i--) {\n    const message = messages[i];\n    if (message.messageType === 'chat' && !!message.createdOn) {\n      return message;\n    }\n  }\n  return undefined;\n};\n\n/**\n * Compare latestMessageFromPreviousMessages & latestMessageFromNewMessages to see if the new message is not from\n * current user.\n */\nconst isThereNewMessageNotFromCurrentUser = (userId: string, latestMessageFromPreviousMessages?: ChatMessage, latestMessageFromNewMessages?: ChatMessage): boolean => {\n  if (latestMessageFromNewMessages === undefined) {\n    return false;\n  }\n  if (latestMessageFromPreviousMessages === undefined) {\n    return latestMessageFromNewMessages.senderId !== userId;\n  }\n  return !isMessageSame(latestMessageFromNewMessages, latestMessageFromPreviousMessages) && latestMessageFromNewMessages.senderId !== userId;\n};\n\n/**\n * Returns true if the current user sent the latest message and false otherwise. It will ignore messages that have no\n * sender, messages that have failed to send, and messages from the current user that is marked as SEEN. This is meant\n * as an indirect way to detect if user is at bottom of the chat when the component updates with new messages. If we\n * updated this component due to current user sending a message we want to then call scrollToBottom.\n */\nconst didUserSendTheLatestMessage = (userId: string, latestMessageFromPreviousMessages?: ChatMessage, latestMessageFromNewMessages?: ChatMessage): boolean => {\n  if (latestMessageFromNewMessages === undefined) {\n    return false;\n  }\n  if (latestMessageFromPreviousMessages === undefined) {\n    return latestMessageFromNewMessages.senderId === userId;\n  }\n  return !isMessageSame(latestMessageFromNewMessages, latestMessageFromPreviousMessages) && latestMessageFromNewMessages.senderId === userId;\n};\n\n/**\n * Fluent styles for {@link MessageThread}.\n *\n * @public\n */\nexport interface MessageThreadStyles extends BaseCustomStyles {\n  /** Styles for load previous messages container. */\n  loadPreviousMessagesButtonContainer?: IStyle;\n  /** Styles for new message container. */\n  newMessageButtonContainer?: IStyle;\n  /** Styles for chat container. */\n  chatContainer?: ComponentSlotStyle;\n  /** styles for my chat items.  */\n  myChatItemMessageContainer?: ComponentSlotStyle;\n  /** styles for chat items.  */\n  chatItemMessageContainer?: ComponentSlotStyle;\n  /** Styles for my chat message container. */\n  myChatMessageContainer?: ComponentSlotStyle;\n  /** Styles for my chat message container in case of failure. */\n  failedMyChatMessageContainer?: ComponentSlotStyle;\n  /** Styles for chat message container. */\n  chatMessageContainer?: ComponentSlotStyle;\n  /** Styles for system message container. */\n  systemMessageContainer?: ComponentSlotStyle;\n  /** Styles for blocked message container. */\n  /** Styles for message status indicator container. */\n  messageStatusContainer?: (mine: boolean) => IStyle;\n}\n\n/**\n * Strings of {@link MessageThread} that can be overridden.\n *\n * @public\n */\nexport interface MessageThreadStrings {\n  /** String for Sunday */\n  sunday: string;\n  /** String for Monday */\n  monday: string;\n  /** String for Tuesday */\n  tuesday: string;\n  /** String for Wednesday */\n  wednesday: string;\n  /** String for Thursday */\n  thursday: string;\n  /** String for Friday */\n  friday: string;\n  /** String for Saturday */\n  saturday: string;\n  /** String for Yesterday */\n  yesterday: string;\n  /** String for participants joined */\n  participantJoined: string;\n  /** String for participants left */\n  participantLeft: string;\n  /** Tag shown on a message that has been edited */\n  editedTag: string;\n  /** String for editing message in floating menu */\n  editMessage: string;\n  /** String for removing message in floating menu */\n  removeMessage: string;\n  /** String for resending failed message in floating menu */\n  resendMessage?: string;\n  /** String for indicating failed to send messages */\n  failToSendTag?: string;\n  /** String for LiveMessage introduction for the Chat Message */\n  liveAuthorIntro: string;\n  /** String for aria text of remote user's message content */\n  messageContentAriaText: string;\n  /** String for aria text of local user's message content */\n  messageContentMineAriaText: string;\n  /** String for warning on text limit exceeded in EditBox*/\n  editBoxTextLimit: string;\n  /** String for placeholder text in EditBox when there is no user input*/\n  editBoxPlaceholderText: string;\n  /** String for new messages indicator*/\n  newMessagesIndicator: string;\n  /** String for showing message read status in floating menu */\n  messageReadCount?: string;\n  /** String for replacing display name when there is none*/\n  noDisplayNameSub: string;\n  /** String for Cancel button in EditBox*/\n  editBoxCancelButton: string;\n  /** String for Submit in EditBox when there is no user input*/\n  editBoxSubmitButton: string;\n  /** String for action menu indicating there are more options */\n  actionMenuMoreOptions?: string;\n  /** Aria label to announce when a message is deleted */\n  messageDeletedAnnouncementAriaLabel: string;\n}\n\n/**\n * Arguments for {@link MessageThreadProps.onRenderJumpToNewMessageButton}.\n *\n * @public\n */\nexport interface JumpToNewMessageButtonProps {\n  /** String for button text */\n  text: string;\n  /** Callback for when button is clicked */\n  onClick: () => void;\n}\nconst DefaultJumpToNewMessageButton = (props: JumpToNewMessageButtonProps): JSX.Element => {\n  const {\n    text,\n    onClick\n  } = props;\n  return <PrimaryButton className={newMessageButtonStyle} styles={buttonWithIconStyles} text={text} onClick={onClick} onRenderIcon={() => <Icon iconName=\"Down\" className={DownIconStyle} />} />;\n};\n\n/**\n * A component to render a single message.\n *\n * @public\n */\nexport type MessageRenderer = (props: MessageProps) => JSX.Element;\nconst memoizeAllMessages = memoizeFnAll((message: Message, showMessageDate: boolean, showMessageStatus: boolean, strings: MessageThreadStrings, index: number, onUpdateMessage?: UpdateMessageCallback, onCancelEditMessage?: CancelEditCallback, onDeleteMessage?: (messageId: string) => Promise<void>, onSendMessage?: (content: string) => Promise<void>, disableEditing?: boolean, lastSeenChatMessage?: string, lastSendingChatMessage?: string, lastDeliveredChatMessage?: string): _ChatMessageProps => {\n  let key: string | undefined = message.messageId;\n  let statusToRender: MessageStatus | undefined = undefined;\n  if (message.messageType === 'chat') {\n    if ((!message.messageId || message.messageId === '') && 'clientMessageId' in message) {\n      key = message.clientMessageId;\n    }\n    if (showMessageStatus && message.mine) {\n      switch (message.messageId) {\n        case lastSeenChatMessage:\n          {\n            statusToRender = 'seen';\n            break;\n          }\n        case lastSendingChatMessage:\n          {\n            statusToRender = 'sending';\n            break;\n          }\n        case lastDeliveredChatMessage:\n          {\n            statusToRender = 'delivered';\n            break;\n          }\n      }\n    }\n    if (message.mine && message.status === 'failed') {\n      statusToRender = 'failed';\n    }\n  }\n  return {\n    key: key ?? 'id_' + index,\n    statusToRender,\n    message,\n    strings,\n    showDate: showMessageDate,\n    onUpdateMessage,\n    onCancelEditMessage,\n    onDeleteMessage,\n    onSendMessage,\n    disableEditing,\n    showMessageStatus\n  };\n});\nconst getLastChatMessageIdWithStatus = (messages: Message[], status: MessageStatus): string | undefined => {\n  for (let i = messages.length - 1; i >= 0; i--) {\n    const message = messages[i];\n    if (message.messageType === 'chat' && message.status === status && message.mine) {\n      return message.messageId;\n    }\n  }\n  return undefined;\n};\nconst getLastChatMessageForCurrentUser = (messages: Message[]): ChatMessage | undefined => {\n  for (let i = messages.length - 1; i >= 0; i--) {\n    const message = messages[i];\n    if (message.messageType === 'chat' && message.mine) {\n      return message;\n    }\n  }\n  return undefined;\n};\n\n/**\n * @public\n * Callback function run when a message is updated.\n */\nexport type UpdateMessageCallback = (messageId: string, content: string) => Promise<void>;\n/**\n * @public\n * Callback function run when a message edit is cancelled.\n */\nexport type CancelEditCallback = (messageId: string) => void;\n\n/**\n * Props for {@link MessageThread}.\n *\n * @public\n */\nexport type MessageThreadProps = {\n  /**\n   * UserId of the current user.\n   */\n  userId: string;\n  /**\n   * Messages to render in message thread. A message can be of type `ChatMessage`, `SystemMessage`, `BlockedMessage` or `CustomMessage`.\n   */\n  messages: (ChatMessage | SystemMessage | CustomMessage)[];\n  /**\n   * number of participants in the thread\n   */\n  participantCount?: number;\n  /**\n   * read receipts for each sender in the chat\n   */\n  readReceiptsBySenderId?: ReadReceiptsBySenderId;\n  /**\n   * Allows users to pass an object containing custom CSS styles.\n   * @Example\n   * ```\n   * <MessageThread styles={{ root: { background: 'blue' } }} />\n   * ```\n   */\n  styles?: MessageThreadStyles;\n  /**\n   * Whether the new message button is disabled or not.\n   *\n   * @defaultValue `false`\n   */\n  disableJumpToNewMessageButton?: boolean;\n  /**\n   * Whether the date of each message is displayed or not.\n   * It is ignored when onDisplayDateTimeString is supplied.\n   *\n   * @defaultValue `false`\n   */\n  showMessageDate?: boolean;\n  /**\n   * Whether the status indicator for each message is displayed or not.\n   *\n   * @defaultValue `false`\n   */\n  showMessageStatus?: boolean;\n  /**\n   * Number of chat messages to reload each time onLoadPreviousChatMessages is called.\n   *\n   * @defaultValue 0\n   */\n  numberOfChatMessagesToReload?: number;\n  /**\n   * Optional callback to override actions on message being seen.\n   *\n   * @param messageId - message Id\n   */\n  onMessageSeen?: (messageId: string) => Promise<void>;\n  /**\n   * Optional callback to override render of the message status indicator.\n   *\n   * @param messageStatusIndicatorProps - props of type MessageStatusIndicatorProps\n   */\n  onRenderMessageStatus?: (messageStatusIndicatorProps: MessageStatusIndicatorProps) => JSX.Element | null;\n  /**\n   * Optional callback to override render of the avatar.\n   *\n   * @param userId - user Id\n   */\n  onRenderAvatar?: OnRenderAvatarCallback;\n  /**\n   * Optional callback to override render of the button for jumping to the new message.\n   *\n   * @param newMessageButtonProps - button props of type JumpToNewMessageButtonProps 0  */\n  onRenderJumpToNewMessageButton?: (newMessageButtonProps: JumpToNewMessageButtonProps) => JSX.Element;\n  /**\n   * Optional callback to override loading of previous messages.\n   * It accepts the number of history chat messages that we want to load and return a boolean Promise indicating if we have got all the history messages.\n   * If the promise resolves to `true`, we have load all chat messages into the message thread and `loadPreviousMessagesButton` will not be rendered anymore.\n   */\n  onLoadPreviousChatMessages?: (messagesToLoad: number) => Promise<boolean>;\n  /**\n   * Optional callback to override render of a message.\n   *\n   * @param messageProps - props of type {@link communication-react#MessageProps}\n   * @param defaultOnRender - default render of type {@link communication-react#MessageRenderer}\n   *\n   * @remarks\n   * `messageRenderer` is not provided for `CustomMessage` and thus only available for `ChatMessage` and `SystemMessage`.\n   */\n  onRenderMessage?: (messageProps: MessageProps, messageRenderer?: MessageRenderer) => JSX.Element;\n  /**\n   * Optional callback to edit a message.\n   *\n   * @param messageId - message id from chatClient\n   * @param content - new content of the message\n   *\n   */\n  onUpdateMessage?: UpdateMessageCallback;\n\n  /**\n   * Optional callback for when a message edit is cancelled.\n   *\n   * @param messageId - message id from chatClient\n   */\n  onCancelEditMessage?: CancelEditCallback;\n  /**\n   * Optional callback to delete a message.\n   *\n   * @param messageId - message id from chatClient\n   *\n   */\n  onDeleteMessage?: (messageId: string) => Promise<void>;\n\n  /**\n   * Optional callback to send a message.\n   *\n   * @param content - message body to send\n   *\n   */\n  onSendMessage?: (content: string) => Promise<void>;\n\n  /**\n  /**\n   * Disable editing messages.\n   *\n   * @remarks This removes the action menu on messages.\n   *\n   * @defaultValue `false`\n   */\n  disableEditing?: boolean;\n\n  /**\n   * Optional strings to override in component\n   */\n  strings?: Partial<MessageThreadStrings>;\n  /* @conditional-compile-remove(image-overlay) */\n  /**\n   * Optional callback called when an inline image is clicked.\n   * @beta\n   */\n  inlineImageOptions?: InlineImageOptions;\n};\n\n/**\n * Props to render a single message.\n *\n * See {@link MessageRenderer}.\n *\n * @public\n */\nexport type MessageProps = {\n  /**\n   * Message to render. It can type `ChatMessage` or `SystemMessage`, `BlockedMessage` or `CustomMessage`.\n   */\n  message: Message;\n  /**\n   * Strings from parent MessageThread component\n   */\n  strings: MessageThreadStrings;\n  /**\n   * Custom CSS styles for chat message container.\n   */\n  messageContainerStyle?: ComponentSlotStyle;\n  /**\n   * Whether the date of a message is displayed or not.\n   *\n   * @defaultValue `false`\n   */\n  showDate?: boolean;\n  /**\n   * Disable editing messages.\n   *\n   * @remarks This removes the action menu on messages.\n   *\n   * @defaultValue `false`\n   */\n  disableEditing?: boolean;\n  /**\n   * Optional callback to edit a message.\n   *\n   * @param messageId - message id from chatClient\n   * @param content - new content of the message\n   */\n  onUpdateMessage?: UpdateMessageCallback;\n\n  /**\n   * Optional callback for when a message edit is cancelled.\n   *\n   * @param messageId - message id from chatClient\n   */\n  onCancelEditMessage?: CancelEditCallback;\n  /**\n   * Optional callback to delete a message.\n   *\n   * @param messageId - message id from chatClient\n   *\n   */\n  onDeleteMessage?: (messageId: string) => Promise<void>;\n\n  /**\n   * Optional callback to send a message.\n   *\n   * @param messageId - message id from chatClient\n   *\n   */\n  onSendMessage?: (messageId: string) => Promise<void>;\n};\n\n/**\n * @internal\n */\nexport type _ChatMessageProps = MessageProps & {\n  key: string;\n  statusToRender: MessageStatus | undefined;\n  showMessageStatus?: boolean;\n};\n\n/**\n * `MessageThread` allows you to easily create a component for rendering chat messages, handling scrolling behavior of new/old messages and customizing icons & controls inside the chat thread.\n * @param props - of type MessageThreadProps\n *\n * Users will need to provide at least chat messages and userId to render the `MessageThread` component.\n * Users can also customize `MessageThread` by passing in their own Avatar, `MessageStatusIndicator` icon, `JumpToNewMessageButton`, `LoadPreviousMessagesButton` and the behavior of these controls.\n *\n * `MessageThread` internally uses the `Chat` component from `@fluentui-contrib/chat`. You can checkout the details about these components [here](https://microsoft.github.io/fluentui-contrib/react-chat/).\n *\n * @public\n */\nexport const MessageThread = (props: MessageThreadProps): JSX.Element => {\n  const theme = useTheme();\n  const chatBody = useMemo(() => {\n    return <FluentV9ThemeProvider v8Theme={theme}>\n        {/* Wrapper is required to call \"useClasses\" hook with proper context values */}\n        <MessageThreadWrapper {...props} />\n      </FluentV9ThemeProvider>;\n  }, [theme, props]);\n  return <div className={mergeStyles(messageThreadContainerStyle, props.styles?.root)}>{chatBody}</div>;\n};\n\n/**\n * @private\n */\nexport const MessageThreadWrapper = (props: MessageThreadProps): JSX.Element => {\n  const {\n    messages: newMessages,\n    userId,\n    participantCount,\n    readReceiptsBySenderId,\n    styles,\n    disableJumpToNewMessageButton = false,\n    showMessageDate = false,\n    showMessageStatus = false,\n    numberOfChatMessagesToReload = 5,\n    onMessageSeen,\n    onRenderMessageStatus,\n    onRenderAvatar,\n    onLoadPreviousChatMessages,\n    onRenderJumpToNewMessageButton,\n    onRenderMessage,\n    onUpdateMessage,\n    onCancelEditMessage,\n    onDeleteMessage,\n    onSendMessage,\n    /* @conditional-compile-remove(image-overlay) */\n    inlineImageOptions\n  } = props;\n  // We need this state to wait for one tick and scroll to bottom after messages have been initialized.\n  // Otherwise chatScrollDivRef.current.clientHeight is wrong if we scroll to bottom before messages are initialized.\n  const [chatMessagesInitialized, setChatMessagesInitialized] = useState<boolean>(false);\n  const [isAtBottomOfScroll, setIsAtBottomOfScroll] = useState<boolean>(true);\n  const [forceUpdate, setForceUpdate] = useState<number>(0);\n\n  // Used to decide if should auto scroll to bottom or show \"new message\" button\n  const [latestPreviousChatMessage, setLatestPreviousChatMessage] = useState<ChatMessage | undefined>(undefined);\n  const [latestCurrentChatMessage, setLatestCurrentChatMessage] = useState<ChatMessage | undefined>(undefined);\n  const [existsNewChatMessage, setExistsNewChatMessage] = useState<boolean>(false);\n  const [lastSeenChatMessage, setLastSeenChatMessage] = useState<string | undefined>(undefined);\n  const [lastDeliveredChatMessage, setLastDeliveredChatMessage] = useState<string | undefined>(undefined);\n  const [lastSendingChatMessage, setLastSendingChatMessage] = useState<string | undefined>(undefined);\n\n  // readCount and participantCount will only need to be updated on-fly when user hover on an indicator\n  const [readCountForHoveredIndicator, setReadCountForHoveredIndicator] = useState<number | undefined>(undefined);\n  const localeStrings = useLocale().strings.messageThread;\n  const strings = useMemo(() => ({\n    ...localeStrings,\n    ...props.strings\n  }), [localeStrings, props.strings]);\n  // it is required to use useState for messages\n  // as the scrolling logic requires re - render at a specific point in time\n  const [messages, setMessages] = useState<Message[]>([]);\n\n  // id for the latest deleted message\n  const [latestDeletedMessageId, setLatestDeletedMessageId] = useState<string | undefined>(undefined);\n  // this value is used to check if a message is deleted for the previous value of messages array\n  const previousMessagesRef = useRef<Message[]>([]);\n  // an aria label for Narrator to notify when a message is deleted\n  const [deletedMessageAriaLabel, setDeletedMessageAriaLabel] = useState<string | undefined>(undefined);\n  const onDeleteMessageCallback = useCallback(async (messageId: string): Promise<void> => {\n    if (!onDeleteMessage) {\n      return;\n    }\n    try {\n      // reset deleted message label in case if there was a value already (messages are deleted 1 after another)\n      setDeletedMessageAriaLabel(undefined);\n      setLatestDeletedMessageId(messageId);\n      lastChatMessageStatus.current = 'deleted';\n      // we should set up latestDeletedMessageId before the onDeleteMessage call\n      // as otherwise in very rare cases the messages array can be updated before latestDeletedMessageId\n      await onDeleteMessage(messageId);\n    } catch (e) {\n      console.log('onDeleteMessage failed: messageId', messageId, 'error', e);\n    }\n  }, [onDeleteMessage]);\n  const isAllChatMessagesLoadedRef = useRef(false);\n  // isAllChatMessagesLoadedRef needs to be updated every time when a new adapter is set in order to display correct data\n  // onLoadPreviousChatMessages is updated when a new adapter is set\n  useEffect(() => {\n    if (onLoadPreviousChatMessages) {\n      isAllChatMessagesLoadedRef.current = false;\n    }\n  }, [onLoadPreviousChatMessages]);\n  const previousTopRef = useRef<number>(-1);\n  const previousHeightRef = useRef<number>(-1);\n  const messageIdSeenByMeRef = useRef<string>('');\n  const chatScrollDivRef = useRef<HTMLDivElement>(null);\n  const isLoadingChatMessagesRef = useRef(false);\n  useEffect(() => {\n    if (latestDeletedMessageId === undefined) {\n      setDeletedMessageAriaLabel(undefined);\n    } else {\n      if (!previousMessagesRef.current.find(message => message.messageId === latestDeletedMessageId)) {\n        // the message is deleted in previousMessagesRef\n        // no need to update deletedMessageAriaLabel\n        setDeletedMessageAriaLabel(undefined);\n      } else if (!messages.find(message => message.messageId === latestDeletedMessageId)) {\n        // the message is deleted in messages array but still exists in previousMessagesRef\n        // update deletedMessageAriaLabel\n        setDeletedMessageAriaLabel(strings.messageDeletedAnnouncementAriaLabel);\n      } else {\n        // the message exists in both arrays\n        // no need to update deletedMessageAriaLabel\n        setDeletedMessageAriaLabel(undefined);\n      }\n    }\n    previousMessagesRef.current = messages;\n  }, [latestDeletedMessageId, messages, strings.messageDeletedAnnouncementAriaLabel]);\n  const messagesRef = useRef(messages);\n  const setMessagesRef = (messagesWithAttachedValue: Message[]): void => {\n    messagesRef.current = messagesWithAttachedValue;\n    setMessages(messagesWithAttachedValue);\n  };\n  const isAtBottomOfScrollRef = useRef(isAtBottomOfScroll);\n  const setIsAtBottomOfScrollRef = (isAtBottomOfScrollValue: boolean): void => {\n    isAtBottomOfScrollRef.current = isAtBottomOfScrollValue;\n    setIsAtBottomOfScroll(isAtBottomOfScrollValue);\n  };\n  const chatMessagesInitializedRef = useRef(chatMessagesInitialized);\n  const setChatMessagesInitializedRef = (chatMessagesInitialized: boolean): void => {\n    chatMessagesInitializedRef.current = chatMessagesInitialized;\n    setChatMessagesInitialized(chatMessagesInitialized);\n  };\n  const chatThreadRef = useRef<HTMLDivElement>(null);\n\n  // When the chat thread is narrow, we perform space optimizations such as overlapping\n  // the avatar on top of the chat message and moving the chat accept/reject edit buttons\n  // to a new line\n  const chatThreadWidth = _useContainerWidth(chatThreadRef);\n  const isNarrow = chatThreadWidth ? isNarrowWidth(chatThreadWidth) : false;\n\n  /**\n   * ClientHeight controls the number of messages to render. However ClientHeight will not be initialized after the\n   * first render (not sure but I guess Fluent is updating it in hook which is after render maybe?) so we need to\n   * trigger a re-render until ClientHeight is initialized. This force re-render should only happen once.\n   */\n  const clientHeight = chatThreadRef.current?.clientHeight;\n\n  // we try to only send those message status if user is scrolled to the bottom.\n  const sendMessageStatusIfAtBottom = useCallback(async (): Promise<void> => {\n    if (!isAtBottomOfScrollRef.current || !document.hasFocus() || !messagesRef.current || messagesRef.current.length === 0 || !showMessageStatus) {\n      return;\n    }\n    const messagesWithId = messagesRef.current.filter(message => {\n      return message.messageType === 'chat' && !message.mine && !!message.messageId;\n    });\n    if (messagesWithId.length === 0) {\n      return;\n    }\n    const lastMessage: ChatMessage = (messagesWithId[messagesWithId.length - 1] as ChatMessage);\n    try {\n      if (onMessageSeen && lastMessage && lastMessage.messageId && lastMessage.messageId !== messageIdSeenByMeRef.current) {\n        await onMessageSeen(lastMessage.messageId);\n        messageIdSeenByMeRef.current = lastMessage.messageId;\n      }\n    } catch (e) {\n      console.log('onMessageSeen Error', lastMessage, e);\n    }\n  }, [showMessageStatus, onMessageSeen]);\n  const scrollToBottom = useCallback((): void => {\n    if (chatScrollDivRef.current) {\n      chatScrollDivRef.current.scrollTop = chatScrollDivRef.current.scrollHeight;\n    }\n    setExistsNewChatMessage(false);\n    setIsAtBottomOfScrollRef(true);\n    sendMessageStatusIfAtBottom();\n  }, [sendMessageStatusIfAtBottom]);\n  const handleScrollToTheBottom = useCallback((): void => {\n    if (!chatScrollDivRef.current) {\n      return;\n    }\n    const atBottom = Math.ceil(chatScrollDivRef.current.scrollTop) >= chatScrollDivRef.current.scrollHeight - chatScrollDivRef.current.clientHeight;\n    if (atBottom) {\n      sendMessageStatusIfAtBottom();\n      if (!isAtBottomOfScrollRef.current) {\n        scrollToBottom();\n      }\n    }\n    setIsAtBottomOfScrollRef(atBottom);\n  }, [scrollToBottom, sendMessageStatusIfAtBottom]);\n\n  // Infinite scrolling + threadInitialize function\n  const fetchNewMessageWhenAtTop = useCallback(async () => {\n    if (!isLoadingChatMessagesRef.current) {\n      if (onLoadPreviousChatMessages) {\n        isLoadingChatMessagesRef.current = true;\n        try {\n          // Fetch message until scrollTop reach the threshold for fetching new message\n          while (!isAllChatMessagesLoadedRef.current && chatScrollDivRef.current && chatScrollDivRef.current.scrollTop <= 500) {\n            isAllChatMessagesLoadedRef.current = await onLoadPreviousChatMessages(numberOfChatMessagesToReload);\n            await delay(200);\n          }\n        } finally {\n          // Set isLoadingChatMessagesRef to false after messages are fetched\n          isLoadingChatMessagesRef.current = false;\n        }\n      }\n    }\n  }, [numberOfChatMessagesToReload, onLoadPreviousChatMessages]);\n\n  // The below 2 of useEffects are design for fixing infinite scrolling problem\n  // Scrolling element will behave differently when scrollTop = 0(it sticks at the top)\n  // we need to get previousTop before it prepend contents\n  // Execute order [newMessage useEffect] => get previousTop => dom update => [messages useEffect]\n  useEffect(() => {\n    if (!chatScrollDivRef.current) {\n      return;\n    }\n    previousTopRef.current = chatScrollDivRef.current.scrollTop;\n    previousHeightRef.current = chatScrollDivRef.current.scrollHeight;\n  }, [newMessages]);\n  useEffect(() => {\n    if (!chatScrollDivRef.current) {\n      return;\n    }\n    chatScrollDivRef.current.scrollTop = chatScrollDivRef.current.scrollHeight - (previousHeightRef.current - previousTopRef.current);\n  }, [messages]);\n\n  // Fetch more messages to make the scroll bar appear, infinity scroll is then handled in the handleScroll function.\n  useEffect(() => {\n    fetchNewMessageWhenAtTop();\n  }, [fetchNewMessageWhenAtTop]);\n\n  /**\n   * One time run useEffects. Sets up listeners when component is mounted and tears down listeners when component\n   * unmounts unless these function changed\n   */\n  useEffect(() => {\n    window && window.addEventListener('click', sendMessageStatusIfAtBottom);\n    window && window.addEventListener('focus', sendMessageStatusIfAtBottom);\n    return () => {\n      window && window.removeEventListener('click', sendMessageStatusIfAtBottom);\n      window && window.removeEventListener('focus', sendMessageStatusIfAtBottom);\n    };\n  }, [sendMessageStatusIfAtBottom]);\n  useEffect(() => {\n    const chatScrollDiv = chatScrollDivRef.current;\n    chatScrollDiv?.addEventListener('scroll', handleScrollToTheBottom);\n    chatScrollDiv?.addEventListener('scroll', fetchNewMessageWhenAtTop);\n    return () => {\n      chatScrollDiv?.removeEventListener('scroll', handleScrollToTheBottom);\n      chatScrollDiv?.removeEventListener('scroll', fetchNewMessageWhenAtTop);\n    };\n  }, [fetchNewMessageWhenAtTop, handleScrollToTheBottom]);\n  useEffect(() => {\n    if (clientHeight === undefined) {\n      setForceUpdate(forceUpdate + 1);\n      return;\n    }\n    // Only scroll to bottom if isAtBottomOfScrollRef is true\n    isAtBottomOfScrollRef.current && scrollToBottom();\n  }, [clientHeight, forceUpdate, scrollToBottom, chatMessagesInitialized]);\n  useEffect(() => {\n    const newStatus = getLastChatMessageForCurrentUser(newMessages)?.status;\n    if (newStatus !== undefined) {\n      if (lastChatMessageStatus.current === 'deleted' && newStatus === 'sending') {\n        // enforce message life cycle\n        // message status should always be [ sending -> delivered -> seen (optional) -> deleted ] or [sending -> failed -> deleted]\n        // not any other way around\n        // therefore, if current message status is deleted, we should only update it if newStatus is sending\n        lastChatMessageStatus.current = newStatus;\n      } else if (lastChatMessageStatus.current !== 'deleted') {\n        lastChatMessageStatus.current = newStatus;\n      }\n    }\n    // The hook should depend on newMessages not on messages as otherwise it will skip the sending status for a first message\n  }, [newMessages]);\n\n  /**\n   * This needs to run to update latestPreviousChatMessage & latestCurrentChatMessage.\n   * These two states are used to manipulate scrollbar\n   */\n  useEffect(() => {\n    setLatestPreviousChatMessage(getLatestChatMessage(messagesRef.current));\n    setLatestCurrentChatMessage(getLatestChatMessage(newMessages));\n    setMessagesRef(newMessages);\n    !chatMessagesInitializedRef.current && setChatMessagesInitializedRef(true);\n    setLastDeliveredChatMessage(getLastChatMessageIdWithStatus(newMessages, 'delivered'));\n    setLastSeenChatMessage(getLastChatMessageIdWithStatus(newMessages, 'seen'));\n    setLastSendingChatMessage(getLastChatMessageIdWithStatus(newMessages, 'sending'));\n  }, [newMessages]);\n\n  /**\n   * This needs to run after messages are rendered so we can manipulate the scroll bar.\n   */\n  useEffect(() => {\n    // If user just sent the latest message then we assume we can move user to bottom of scroll.\n    if (isThereNewMessageNotFromCurrentUser(userId, latestPreviousChatMessage, latestCurrentChatMessage) && !isAtBottomOfScrollRef.current) {\n      setExistsNewChatMessage(true);\n    } else if (didUserSendTheLatestMessage(userId, latestPreviousChatMessage, latestCurrentChatMessage) || isAtBottomOfScrollRef.current) {\n      scrollToBottom();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [messages]);\n  const lastChatMessageStatus = useRef<string | undefined>(undefined);\n  const participantCountRef = useRef(participantCount);\n  const readReceiptsBySenderIdRef = useRef(readReceiptsBySenderId);\n  participantCountRef.current = participantCount;\n  readReceiptsBySenderIdRef.current = readReceiptsBySenderId;\n  const onActionButtonClickMemo = useCallback((message: ChatMessage, setMessageReadBy: (readBy: {\n    id: string;\n    displayName: string;\n  }[]) => void) => {\n    if (participantCountRef.current && participantCountRef.current - 1 > 1 && readReceiptsBySenderIdRef.current) {\n      setMessageReadBy(getParticipantsWhoHaveReadMessage(message, readReceiptsBySenderIdRef.current));\n    }\n  }, []);\n  const defaultStatusRenderer = useCallback((message: ChatMessage, participantCount: number, readCount: number, status?: MessageStatus) => {\n    // we should only announce label if the message status isn't deleted\n    // because after message is deleted, we now need to render statusIndicator for previous messages\n    // and their status has been announced already and we should not announce them again\n    const shouldAnnounce = lastChatMessageStatus.current !== 'deleted';\n    const onToggleToolTip = (isToggled: boolean): void => {\n      if (isToggled && readReceiptsBySenderIdRef.current) {\n        setReadCountForHoveredIndicator(getParticipantsWhoHaveReadMessage(message, readReceiptsBySenderIdRef.current).length);\n      } else {\n        setReadCountForHoveredIndicator(undefined);\n      }\n    };\n    return <MessageStatusIndicatorInternal status={status} readCount={readCount} onToggleToolTip={onToggleToolTip}\n    // -1 because participant count does not include myself\n    remoteParticipantsCount={participantCount ? participantCount - 1 : 0} shouldAnnounce={shouldAnnounce} />;\n  }, []);\n  const theme = useTheme();\n  const messagesToDisplay = useMemo(() => {\n    return memoizeAllMessages(memoizedMessageFn => {\n      return messages.map((message: Message, index: number): _ChatMessageProps => {\n        return memoizedMessageFn(message, showMessageDate, showMessageStatus, strings, index, onUpdateMessage, onCancelEditMessage, onDeleteMessageCallback, onSendMessage, props.disableEditing, lastDeliveredChatMessage, lastSeenChatMessage, lastSendingChatMessage);\n      });\n    });\n  }, [lastDeliveredChatMessage, lastSeenChatMessage, lastSendingChatMessage, messages, onCancelEditMessage, onDeleteMessageCallback, onSendMessage, onUpdateMessage, props.disableEditing, showMessageDate, showMessageStatus, strings]);\n  const classes = useChatStyles();\n  return <div className={mergeStyles(messageThreadWrapperContainerStyle)} ref={chatThreadRef}>\n      {/* Always ensure New Messages button is above the chat body element in the DOM tree. This is to ensure correct\n        tab ordering. Because the New Messages button floats on top of the chat body it is in a higher z-index and\n        thus Users should be able to tab navigate to the new messages button _before_ tab focus is taken to the chat body.*/}\n      {existsNewChatMessage && !disableJumpToNewMessageButton && <div className={mergeStyles(newMessageButtonContainerStyle, styles?.newMessageButtonContainer)}>\n          {onRenderJumpToNewMessageButton ? onRenderJumpToNewMessageButton({\n        text: strings.newMessagesIndicator,\n        onClick: scrollToBottom\n      }) : <DefaultJumpToNewMessageButton text={strings.newMessagesIndicator} onClick={scrollToBottom} />}\n        </div>}\n      <LiveAnnouncer>\n        <FluentV9ThemeProvider v8Theme={theme}>\n          {latestDeletedMessageId && <Announcer key={latestDeletedMessageId} announcementString={deletedMessageAriaLabel} ariaLive={'assertive'} />}\n          <Chat\n        // styles?.chatContainer used in className and style prop as style prop can't handle CSS selectors\n        className={mergeClasses(classes.root, mergeStyles(styles?.chatContainer))} ref={chatScrollDivRef} style={{\n          ...createStyleFromV8Style(styles?.chatContainer)\n        }}>\n            {messagesToDisplay.map((message: _ChatMessageProps): JSX.Element => {\n            return <MemoChatMessageComponentWrapper {...message} userId={userId} key={message.key} styles={styles} shouldOverlapAvatarAndMessage={isNarrow} strings={strings} onRenderAvatar={onRenderAvatar} onRenderMessage={onRenderMessage} onRenderMessageStatus={onRenderMessageStatus} defaultStatusRenderer={defaultStatusRenderer} onActionButtonClick={onActionButtonClickMemo} readCount={readCountForHoveredIndicator} participantCount={participantCount} /* @conditional-compile-remove(image-overlay) */\n            inlineImageOptions={inlineImageOptions} />;\n          })}\n          </Chat>\n        </FluentV9ThemeProvider>\n      </LiveAnnouncer>\n    </div>;\n};\nconst MemoChatMessageComponentWrapper = React.memo((obj: ChatMessageComponentWrapperProps): JSX.Element => {\n  return <ChatMessageComponentWrapper {...obj} />;\n});"]}