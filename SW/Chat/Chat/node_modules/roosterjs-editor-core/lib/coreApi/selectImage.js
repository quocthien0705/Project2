"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.selectImage = void 0;
var addUniqueId_1 = require("./utils/addUniqueId");
var roosterjs_editor_dom_1 = require("roosterjs-editor-dom");
var IMAGE_ID = 'imageSelected';
var CONTENT_DIV_ID = 'contentDiv_';
var STYLE_ID = 'imageStyle';
var DEFAULT_SELECTION_BORDER_COLOR = '#DB626C';
/**
 * @internal
 * Select a image and save data of the selected range
 * @param image Image to select
 * @returns Selected image information
 */
var selectImage = function (core, image) {
    unselect(core);
    var selection = null;
    if (image) {
        var range = (0, roosterjs_editor_dom_1.createRange)(image);
        (0, addUniqueId_1.default)(image, IMAGE_ID);
        (0, addUniqueId_1.default)(core.contentDiv, CONTENT_DIV_ID);
        core.api.selectRange(core, (0, roosterjs_editor_dom_1.createRange)(new roosterjs_editor_dom_1.Position(image, -3 /* After */)));
        select(core, image);
        selection = {
            type: 2 /* ImageSelection */,
            ranges: [range],
            image: image,
            areAllCollapsed: range.collapsed,
        };
    }
    return selection;
};
exports.selectImage = selectImage;
var select = function (core, image) {
    (0, roosterjs_editor_dom_1.removeImportantStyleRule)(image, ['border', 'margin']);
    var borderCSS = buildBorderCSS(core, image.id);
    (0, roosterjs_editor_dom_1.setGlobalCssStyles)(core.contentDiv.ownerDocument, borderCSS, STYLE_ID + core.contentDiv.id);
};
var buildBorderCSS = function (core, imageId) {
    var divId = core.contentDiv.id;
    var color = core.imageSelectionBorderColor || DEFAULT_SELECTION_BORDER_COLOR;
    return "#" + divId + " #" + imageId + " {outline-style: auto!important;outline-color: " + color + "!important;caret-color: transparent!important;}";
};
var unselect = function (core) {
    var doc = core.contentDiv.ownerDocument;
    (0, roosterjs_editor_dom_1.removeGlobalCssStyle)(doc, STYLE_ID + core.contentDiv.id);
};
//# sourceMappingURL=selectImage.js.map