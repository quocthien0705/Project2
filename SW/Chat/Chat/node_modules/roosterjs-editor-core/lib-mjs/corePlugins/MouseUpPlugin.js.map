{"version":3,"file":"MouseUpPlugin.js","sourceRoot":"","sources":["../../../../packages/roosterjs-editor-core/lib/corePlugins/MouseUpPlugin.ts"],"names":[],"mappings":"AAGA;;;;GAIG;AACH;IAAA;QAAA,iBA+DC;QA9DW,WAAM,GAAmB,IAAI,CAAC;QAC9B,4BAAuB,GAAY,KAAK,CAAC;QACzC,eAAU,GAAkB,IAAI,CAAC;QACjC,eAAU,GAAkB,IAAI,CAAC;QAkDjC,cAAS,GAAG,UAAC,QAAoB;YACrC,IAAI,KAAI,CAAC,MAAM,EAAE;gBACb,KAAI,CAAC,0BAA0B,EAAE,CAAC;gBAClC,KAAI,CAAC,MAAM,CAAC,kBAAkB,kBAA0B;oBACpD,QAAQ,UAAA;oBACR,UAAU,EAAE,KAAI,CAAC,UAAU,IAAI,QAAQ,CAAC,KAAK,IAAI,KAAI,CAAC,UAAU,IAAI,QAAQ,CAAC,KAAK;iBACrF,CAAC,CAAC;aACN;QACL,CAAC,CAAC;IACN,CAAC;IAzDG;;OAEG;IACH,+BAAO,GAAP;QACI,OAAO,SAAS,CAAC;IACrB,CAAC;IAED;;;OAGG;IACH,kCAAU,GAAV,UAAW,MAAe;QACtB,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;IACzB,CAAC;IAED;;OAEG;IACH,+BAAO,GAAP;QACI,IAAI,CAAC,0BAA0B,EAAE,CAAC;QAClC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;IACvB,CAAC;IAED;;;OAGG;IACH,qCAAa,GAAb,UAAc,KAAkB;QAC5B,IACI,IAAI,CAAC,MAAM;YACX,KAAK,CAAC,SAAS,qBAA6B;YAC5C,CAAC,IAAI,CAAC,uBAAuB,EAC/B;YACE,IAAI,CAAC,MAAM;iBACN,WAAW,EAAE;iBACb,gBAAgB,CAAC,SAAS,EAAE,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,cAAc,CAAC,CAAC;YACtE,IAAI,CAAC,uBAAuB,GAAG,IAAI,CAAC;YACpC,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC;YACvC,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC;SAC1C;IACL,CAAC;IACO,kDAA0B,GAAlC;QACI,IAAI,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,uBAAuB,EAAE;YAC7C,IAAI,CAAC,uBAAuB,GAAG,KAAK,CAAC;YACrC,IAAI,CAAC,MAAM,CAAC,WAAW,EAAE,CAAC,mBAAmB,CAAC,SAAS,EAAE,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;SAClF;IACL,CAAC;IAWL,oBAAC;AAAD,CAAC,AA/DD,IA+DC","sourcesContent":["import { PluginEventType } from 'roosterjs-editor-types';\nimport type { EditorPlugin, IEditor, PluginEvent } from 'roosterjs-editor-types';\n\n/**\n * @internal\n * MouseUpPlugin help trigger MouseUp event even when mouse up happens outside editor\n * as long as the mouse was pressed within Editor before\n */\nexport default class MouseUpPlugin implements EditorPlugin {\n    private editor: IEditor | null = null;\n    private mouseUpEventListerAdded: boolean = false;\n    private mouseDownX: number | null = null;\n    private mouseDownY: number | null = null;\n\n    /**\n     * Get a friendly name of  this plugin\n     */\n    getName() {\n        return 'MouseUp';\n    }\n\n    /**\n     * Initialize this plugin. This should only be called from Editor\n     * @param editor Editor instance\n     */\n    initialize(editor: IEditor) {\n        this.editor = editor;\n    }\n\n    /**\n     * Dispose this plugin\n     */\n    dispose() {\n        this.removeMouseUpEventListener();\n        this.editor = null;\n    }\n\n    /**\n     * Handle events triggered from editor\n     * @param event PluginEvent object\n     */\n    onPluginEvent(event: PluginEvent) {\n        if (\n            this.editor &&\n            event.eventType == PluginEventType.MouseDown &&\n            !this.mouseUpEventListerAdded\n        ) {\n            this.editor\n                .getDocument()\n                .addEventListener('mouseup', this.onMouseUp, true /*setCapture*/);\n            this.mouseUpEventListerAdded = true;\n            this.mouseDownX = event.rawEvent.pageX;\n            this.mouseDownY = event.rawEvent.pageY;\n        }\n    }\n    private removeMouseUpEventListener() {\n        if (this.editor && this.mouseUpEventListerAdded) {\n            this.mouseUpEventListerAdded = false;\n            this.editor.getDocument().removeEventListener('mouseup', this.onMouseUp, true);\n        }\n    }\n\n    private onMouseUp = (rawEvent: MouseEvent) => {\n        if (this.editor) {\n            this.removeMouseUpEventListener();\n            this.editor.triggerPluginEvent(PluginEventType.MouseUp, {\n                rawEvent,\n                isClicking: this.mouseDownX == rawEvent.pageX && this.mouseDownY == rawEvent.pageY,\n            });\n        }\n    };\n}\n"]}