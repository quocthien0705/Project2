{"version":3,"file":"selectTable.js","sourceRoot":"","sources":["../../../../packages/roosterjs-editor-core/lib/coreApi/selectTable.ts"],"names":[],"mappings":"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","sourcesContent":["import addUniqueId from './utils/addUniqueId';\nimport { PositionType, SelectionRangeTypes } from 'roosterjs-editor-types';\nimport {\n    createRange,\n    getTagOfNode,\n    isWholeTableSelected,\n    Position,\n    removeGlobalCssStyle,\n    removeImportantStyleRule,\n    setGlobalCssStyles,\n    toArray,\n    VTable,\n} from 'roosterjs-editor-dom';\nimport type { EditorCore, TableSelection, SelectTable, Coordinates } from 'roosterjs-editor-types';\n\nconst TABLE_ID = 'tableSelected';\nconst CONTENT_DIV_ID = 'contentDiv_';\nconst STYLE_ID = 'tableStyle';\nconst SELECTED_CSS_RULE =\n    '{background-color: rgb(198,198,198) !important; caret-color: transparent}';\nconst MAX_RULE_SELECTOR_LENGTH = 9000;\n\n/**\n * @internal\n * Select a table and save data of the selected range\n * @param core The EditorCore object\n * @param table table to select\n * @param coordinates first and last cell of the selection, if this parameter is null, instead of\n * selecting, will unselect the table.\n * @returns true if successful\n */\nexport const selectTable: SelectTable = (\n    core: EditorCore,\n    table: HTMLTableElement | null,\n    coordinates?: TableSelection\n) => {\n    unselect(core);\n\n    if (areValidCoordinates(coordinates) && table) {\n        addUniqueId(table, TABLE_ID);\n        addUniqueId(core.contentDiv, CONTENT_DIV_ID);\n\n        const { ranges, isWholeTableSelected } = select(core, table, coordinates);\n        if (!isMergedCell(table, coordinates)) {\n            const cellToSelect = table.rows\n                .item(coordinates.firstCell.y)\n                ?.cells.item(coordinates.firstCell.x);\n\n            if (cellToSelect) {\n                core.api.selectRange(\n                    core,\n                    createRange(new Position(cellToSelect, PositionType.Begin))\n                );\n            }\n        }\n\n        return {\n            type: SelectionRangeTypes.TableSelection,\n            ranges,\n            table,\n            areAllCollapsed: ranges.filter(range => range?.collapsed).length == ranges.length,\n            coordinates,\n            isWholeTableSelected,\n        };\n    }\n\n    return null;\n};\n\nfunction buildCss(\n    table: HTMLTableElement,\n    coordinates: TableSelection,\n    contentDivSelector: string\n): { cssRules: string[]; ranges: Range[]; isWholeTableSelected: boolean } {\n    const ranges: Range[] = [];\n    const selectors: string[] = [];\n\n    const vTable = new VTable(table);\n    const isAllTableSelected = isWholeTableSelected(vTable, coordinates);\n    if (isAllTableSelected) {\n        handleAllTableSelected(contentDivSelector, vTable, selectors, ranges);\n    } else {\n        handleTableSelected(coordinates, vTable, contentDivSelector, selectors, ranges);\n    }\n\n    const cssRules: string[] = [];\n    let currentRules: string = '';\n    while (selectors.length > 0) {\n        currentRules += (currentRules.length > 0 ? ',' : '') + selectors.shift() || '';\n        if (\n            currentRules.length + (selectors[0]?.length || 0) > MAX_RULE_SELECTOR_LENGTH ||\n            selectors.length == 0\n        ) {\n            cssRules.push(currentRules + ' ' + SELECTED_CSS_RULE);\n            currentRules = '';\n        }\n    }\n\n    return { cssRules, ranges, isWholeTableSelected: isAllTableSelected };\n}\n\nfunction handleAllTableSelected(\n    contentDivSelector: string,\n    vTable: VTable,\n    selectors: string[],\n    ranges: Range[]\n) {\n    const table = vTable.table;\n    const tableSelector = contentDivSelector + ' #' + table.id;\n    selectors.push(tableSelector, `${tableSelector} *`);\n\n    const tableRange = new Range();\n    tableRange.selectNode(table);\n    ranges.push(tableRange);\n}\n\nfunction handleTableSelected(\n    coordinates: TableSelection,\n    vTable: VTable,\n    contentDivSelector: string,\n    selectors: string[],\n    ranges: Range[]\n) {\n    const tr1 = coordinates.firstCell.y;\n    const td1 = coordinates.firstCell.x;\n    const tr2 = coordinates.lastCell.y;\n    const td2 = coordinates.lastCell.x;\n    const table = vTable.table;\n\n    let firstSelected: HTMLTableCellElement | null = null;\n    let lastSelected: HTMLTableCellElement | null = null;\n    // Get whether table has thead, tbody or tfoot.\n    const tableChildren = toArray(table.childNodes).filter(\n        node => ['THEAD', 'TBODY', 'TFOOT'].indexOf(getTagOfNode(node)) > -1\n    );\n    // Set the start and end of each of the table children, so we can build the selector according the element between the table and the row.\n    let cont = 0;\n    const indexes = tableChildren.map(node => {\n        const result = {\n            el: getTagOfNode(node),\n            start: cont,\n            end: node.childNodes.length + cont,\n        };\n\n        cont = result.end;\n        return result;\n    });\n\n    vTable.cells?.forEach((row, rowIndex) => {\n        let tdCount = 0;\n        firstSelected = null;\n        lastSelected = null;\n\n        //Get current TBODY/THEAD/TFOOT\n        const midElement = indexes.filter(ind => ind.start <= rowIndex && ind.end > rowIndex)[0];\n\n        const middleElSelector = midElement ? '>' + midElement.el + '>' : '>';\n        const currentRow =\n            midElement && rowIndex + 1 >= midElement.start\n                ? rowIndex + 1 - midElement.start\n                : rowIndex + 1;\n\n        for (let cellIndex = 0; cellIndex < row.length; cellIndex++) {\n            const cell = row[cellIndex].td;\n            if (cell) {\n                tdCount++;\n                if (rowIndex >= tr1 && rowIndex <= tr2 && cellIndex >= td1 && cellIndex <= td2) {\n                    removeImportant(cell);\n\n                    const selector = generateCssFromCell(\n                        contentDivSelector,\n                        table.id,\n                        middleElSelector,\n                        currentRow,\n                        getTagOfNode(cell),\n                        tdCount\n                    );\n                    const elementsSelector = selector + ' *';\n\n                    selectors.push(selector, elementsSelector);\n                    firstSelected = firstSelected || table.querySelector(selector);\n                    lastSelected = table.querySelector(selector);\n                }\n            }\n        }\n\n        if (firstSelected && lastSelected) {\n            const rowRange = new Range();\n            rowRange.setStartBefore(firstSelected);\n            rowRange.setEndAfter(lastSelected);\n            ranges.push(rowRange);\n        }\n    });\n}\n\nfunction select(\n    core: EditorCore,\n    table: HTMLTableElement,\n    coordinates: TableSelection\n): { ranges: Range[]; isWholeTableSelected: boolean } {\n    const contentDivSelector = '#' + core.contentDiv.id;\n    const { cssRules, ranges, isWholeTableSelected } = buildCss(\n        table,\n        coordinates,\n        contentDivSelector\n    );\n    cssRules.forEach(css =>\n        setGlobalCssStyles(core.contentDiv.ownerDocument, css, STYLE_ID + core.contentDiv.id)\n    );\n\n    return { ranges, isWholeTableSelected };\n}\n\nconst unselect = (core: EditorCore) => {\n    const doc = core.contentDiv.ownerDocument;\n    removeGlobalCssStyle(doc, STYLE_ID + core.contentDiv.id);\n};\n\nfunction generateCssFromCell(\n    contentDivSelector: string,\n    tableId: string,\n    middleElSelector: string,\n    rowIndex: number,\n    cellTag: string,\n    index: number\n): string {\n    return (\n        contentDivSelector +\n        ' #' +\n        tableId +\n        middleElSelector +\n        ' tr:nth-child(' +\n        rowIndex +\n        ')>' +\n        cellTag +\n        ':nth-child(' +\n        index +\n        ')'\n    );\n}\n\nfunction removeImportant(cell: HTMLTableCellElement) {\n    if (cell) {\n        removeImportantStyleRule(cell, ['background-color', 'background']);\n    }\n}\n\nfunction areValidCoordinates(input?: TableSelection): input is TableSelection {\n    if (input) {\n        const { firstCell, lastCell } = input || {};\n        if (firstCell && lastCell) {\n            const handler = (coordinate: Coordinates) =>\n                isValidCoordinate(coordinate.x) && isValidCoordinate(coordinate.y);\n            return handler(firstCell) && handler(lastCell);\n        }\n    }\n\n    return false;\n}\n\nfunction isValidCoordinate(input: number): boolean {\n    return (!!input || input == 0) && input > -1;\n}\n\nfunction isMergedCell(table: HTMLTableElement, coordinates: TableSelection): boolean {\n    const { firstCell } = coordinates;\n    return !(table.rows.item(firstCell.y) && table.rows.item(firstCell.y)?.cells.item(firstCell.x));\n}\n"]}