import addUniqueId from './utils/addUniqueId';
import { createRange, Position, removeGlobalCssStyle, removeImportantStyleRule, setGlobalCssStyles, } from 'roosterjs-editor-dom';
var IMAGE_ID = 'imageSelected';
var CONTENT_DIV_ID = 'contentDiv_';
var STYLE_ID = 'imageStyle';
var DEFAULT_SELECTION_BORDER_COLOR = '#DB626C';
/**
 * @internal
 * Select a image and save data of the selected range
 * @param image Image to select
 * @returns Selected image information
 */
export var selectImage = function (core, image) {
    unselect(core);
    var selection = null;
    if (image) {
        var range = createRange(image);
        addUniqueId(image, IMAGE_ID);
        addUniqueId(core.contentDiv, CONTENT_DIV_ID);
        core.api.selectRange(core, createRange(new Position(image, -3 /* After */)));
        select(core, image);
        selection = {
            type: 2 /* ImageSelection */,
            ranges: [range],
            image: image,
            areAllCollapsed: range.collapsed,
        };
    }
    return selection;
};
var select = function (core, image) {
    removeImportantStyleRule(image, ['border', 'margin']);
    var borderCSS = buildBorderCSS(core, image.id);
    setGlobalCssStyles(core.contentDiv.ownerDocument, borderCSS, STYLE_ID + core.contentDiv.id);
};
var buildBorderCSS = function (core, imageId) {
    var divId = core.contentDiv.id;
    var color = core.imageSelectionBorderColor || DEFAULT_SELECTION_BORDER_COLOR;
    return "#" + divId + " #" + imageId + " {outline-style: auto!important;outline-color: " + color + "!important;caret-color: transparent!important;}";
};
var unselect = function (core) {
    var doc = core.contentDiv.ownerDocument;
    removeGlobalCssStyle(doc, STYLE_ID + core.contentDiv.id);
};
//# sourceMappingURL=selectImage.js.map