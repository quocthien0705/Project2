{"version":3,"file":"getSelectionRange.js","sourceRoot":"","sources":["../../../../packages/roosterjs-editor-core/lib/coreApi/getSelectionRange.ts"],"names":[],"mappings":";;;;IAGA;;;;;;OAMG;IACI,IAAM,iBAAiB,GAAsB,UAChD,IAAgB,EAChB,eAAwB;;QAExB,IAAI,MAAM,GAAiB,IAAI,CAAC;QAEhC,IAAI,IAAI,CAAC,SAAS,CAAC,kBAAkB,EAAE;YACnC,MAAM;gBACF,IAAI,CAAC,SAAS,CAAC,uBAAuB;oBACtC,IAAA,kCAAW,EACP,IAAI,CAAC,UAAU,EACf,IAAI,CAAC,SAAS,CAAC,uBAAuB,CAAC,KAAK,EAC5C,IAAI,CAAC,SAAS,CAAC,uBAAuB,CAAC,GAAG,CAC7C,CAAC;YAEN,OAAO,MAAM,CAAC;SACjB;aAAM;YACH,IAAI,CAAC,eAAe,IAAI,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE;gBAC7C,IAAM,SAAS,GAAG,MAAA,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,WAAW,0CAAE,YAAY,EAAE,CAAC;gBAC5E,IAAI,SAAS,IAAI,SAAS,CAAC,UAAU,GAAG,CAAC,EAAE;oBACvC,IAAM,KAAK,GAAG,SAAS,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;oBACtC,IAAI,IAAA,+BAAQ,EAAC,IAAI,CAAC,UAAU,EAAE,KAAK,CAAC,EAAE;wBAClC,MAAM,GAAG,KAAK,CAAC;qBAClB;iBACJ;aACJ;YAED,IAAI,CAAC,MAAM,IAAI,eAAe,EAAE;gBAC5B,MAAM,GAAG,IAAI,CAAC,QAAQ,CAAC,cAAc,CAAC;aACzC;YAED,OAAO,MAAM,CAAC;SACjB;IACL,CAAC,CAAC;IAjCW,QAAA,iBAAiB,qBAiC5B","sourcesContent":["import { contains, createRange } from 'roosterjs-editor-dom';\nimport type { EditorCore, GetSelectionRange } from 'roosterjs-editor-types';\n\n/**\n * @internal\n * Get current or cached selection range\n * @param core The EditorCore object\n * @param tryGetFromCache Set to true to retrieve the selection range from cache if editor doesn't own the focus now\n * @returns A Range object of the selection range\n */\nexport const getSelectionRange: GetSelectionRange = (\n    core: EditorCore,\n    tryGetFromCache: boolean\n) => {\n    let result: Range | null = null;\n\n    if (core.lifecycle.shadowEditFragment) {\n        result =\n            core.lifecycle.shadowEditSelectionPath &&\n            createRange(\n                core.contentDiv,\n                core.lifecycle.shadowEditSelectionPath.start,\n                core.lifecycle.shadowEditSelectionPath.end\n            );\n\n        return result;\n    } else {\n        if (!tryGetFromCache || core.api.hasFocus(core)) {\n            const selection = core.contentDiv.ownerDocument.defaultView?.getSelection();\n            if (selection && selection.rangeCount > 0) {\n                const range = selection.getRangeAt(0);\n                if (contains(core.contentDiv, range)) {\n                    result = range;\n                }\n            }\n        }\n\n        if (!result && tryGetFromCache) {\n            result = core.domEvent.selectionRange;\n        }\n\n        return result;\n    }\n};\n"]}