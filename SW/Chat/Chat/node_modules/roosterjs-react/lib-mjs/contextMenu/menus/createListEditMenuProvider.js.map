{"version":3,"file":"createListEditMenuProvider.js","sourceRoot":"","sources":["../../../../../packages/roosterjs-react/lib/contextMenu/menus/createListEditMenuProvider.ts"],"names":[],"mappings":"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","sourcesContent":["import createContextMenuProvider from '../utils/createContextMenuProvider';\nimport showInputDialog from '../../inputDialog/utils/showInputDialog';\nimport { safeInstanceOf } from 'roosterjs-editor-dom';\nimport { setOrderedListNumbering } from 'roosterjs-editor-api';\nimport type ContextMenuItem from '../types/ContextMenuItem';\nimport type { EditorPlugin, IEditor } from 'roosterjs-editor-types';\nimport type { ListNumberMenuItemStringKey } from '../types/ContextMenuItemStringKeys';\nimport type { LocalizedStrings } from '../../common/type/LocalizedStrings';\n\nconst ListNumberResetMenuItem: ContextMenuItem<ListNumberMenuItemStringKey> = {\n    key: 'menuNameListNumberReset',\n    unlocalizedText: 'Restart at 1',\n    onClick: (_, editor, node) => {\n        const li = editor.getElementAtCursor('LI', node) as HTMLLIElement;\n        setOrderedListNumbering(editor, li, 1);\n    },\n};\n\nconst ListNumberEditMenuItem: ContextMenuItem<ListNumberMenuItemStringKey> = {\n    key: 'menuNameListNumberEdit',\n    unlocalizedText: 'Set numbering value',\n    onClick: (_, editor, node, strings, uiUtilities) => {\n        const listAndLi = getEditingList(editor, node);\n\n        if (listAndLi) {\n            const { list, li } = listAndLi;\n            let startNumber = list.start;\n\n            for (let child = list.firstChild; child; child = child.nextSibling) {\n                if (child === li) {\n                    break;\n                } else if (safeInstanceOf(child, 'HTMLLIElement')) {\n                    startNumber += 1;\n                }\n            }\n\n            showInputDialog(\n                uiUtilities,\n                'menuNameListNumberEdit',\n                'Set numbering value',\n                {\n                    value: {\n                        labelKey: 'dialogTextSetListNumber',\n                        unlocalizedLabel: 'Set value to',\n                        initValue: startNumber.toString(),\n                    },\n                },\n                strings\n            ).then(values => {\n                editor.focus();\n\n                if (values) {\n                    const result = parseInt(values.value);\n\n                    if (result > 0 && result != startNumber) {\n                        setOrderedListNumbering(editor, li, Math.floor(result));\n                    }\n                }\n            });\n        }\n    },\n};\n\nfunction getEditingList(editor: IEditor, node: Node) {\n    const li = editor.getElementAtCursor('LI', node) as HTMLLIElement;\n    const list = li && (editor.getElementAtCursor('ol', li) as HTMLOListElement);\n\n    return list?.isContentEditable ? { list, li } : null;\n}\n\n/**\n * Create a new instance of ContextMenuProvider to support list number editing functionalities in context menu\n * @returns A new ContextMenuProvider\n */\nexport default function createListEditMenuProvider(\n    strings?: LocalizedStrings<ListNumberMenuItemStringKey>\n): EditorPlugin {\n    return createContextMenuProvider(\n        'listEdit',\n        [ListNumberResetMenuItem, ListNumberEditMenuItem],\n        strings,\n        (editor, node) => !!getEditingList(editor, node)\n    );\n}\n"]}