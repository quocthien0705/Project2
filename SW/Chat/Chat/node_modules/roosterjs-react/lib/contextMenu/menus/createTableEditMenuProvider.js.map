{"version":3,"file":"createTableEditMenuProvider.js","sourceRoot":"","sources":["../../../../../packages/roosterjs-react/lib/contextMenu/menus/createTableEditMenuProvider.ts"],"names":[],"mappings":"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","sourcesContent":["import createContextMenuProvider from '../utils/createContextMenuProvider';\nimport { applyCellShading, editTable } from 'roosterjs-editor-api';\nimport { renderColorPicker } from '../../colorPicker/component/renderColorPicker';\nimport { TableOperation } from 'roosterjs-editor-types';\nimport type ContextMenuItem from '../types/ContextMenuItem';\nimport type { EditorPlugin, IEditor, ModeIndependentColor } from 'roosterjs-editor-types';\nimport type { LocalizedStrings } from '../../common/type/LocalizedStrings';\nimport {\n    getColorPickerContainerClassName,\n    getColorPickerItemClassName,\n} from '../../colorPicker/utils/getClassNamesForColorPicker';\nimport type {\n    TableEditMenuItemStringKey,\n    TableEditInsertMenuItemStringKey,\n    TableEditDeleteMenuItemStringKey,\n    TableEditMergeMenuItemStringKey,\n    TableEditSplitMenuItemStringKey,\n    TableEditAlignMenuItemStringKey,\n    TableEditShadeMenuItemStringKey,\n    TableEditAlignTableMenuItemStringKey,\n} from '../types/ContextMenuItemStringKeys';\nimport {\n    BackgroundColorDropDownItems,\n    BackgroundColors,\n} from '../../colorPicker/utils/backgroundColors';\n\nconst TableEditOperationMap: Partial<Record<TableEditMenuItemStringKey, TableOperation>> = {\n    menuNameTableInsertAbove: TableOperation.InsertAbove,\n    menuNameTableInsertBelow: TableOperation.InsertBelow,\n    menuNameTableInsertLeft: TableOperation.InsertLeft,\n    menuNameTableInsertRight: TableOperation.InsertRight,\n    menuNameTableDeleteTable: TableOperation.DeleteTable,\n    menuNameTableDeleteColumn: TableOperation.DeleteColumn,\n    menuNameTableDeleteRow: TableOperation.DeleteRow,\n    menuNameTableMergeAbove: TableOperation.MergeAbove,\n    menuNameTableMergeBelow: TableOperation.MergeBelow,\n    menuNameTableMergeLeft: TableOperation.MergeLeft,\n    menuNameTableMergeRight: TableOperation.MergeRight,\n    menuNameTableMergeCells: TableOperation.MergeCells,\n    menuNameTableSplitHorizontally: TableOperation.SplitHorizontally,\n    menuNameTableSplitVertically: TableOperation.SplitVertically,\n    menuNameTableAlignLeft: TableOperation.AlignCellLeft,\n    menuNameTableAlignCenter: TableOperation.AlignCellCenter,\n    menuNameTableAlignRight: TableOperation.AlignCellRight,\n    menuNameTableAlignTop: TableOperation.AlignCellTop,\n    menuNameTableAlignMiddle: TableOperation.AlignCellMiddle,\n    menuNameTableAlignBottom: TableOperation.AlignCellBottom,\n    menuNameTableAlignTableLeft: TableOperation.AlignLeft,\n    menuNameTableAlignTableCenter: TableOperation.AlignCenter,\n    menuNameTableAlignTableRight: TableOperation.AlignRight,\n};\n\nconst ColorValues = {\n    ...BackgroundColors,\n    // Add this value to satisfy compiler\n    menuNameTableCellShade: <ModeIndependentColor>(<unknown>null),\n};\n\nfunction onClick(key: TableEditMenuItemStringKey, editor: IEditor) {\n    editor.focus();\n    const operation = TableEditOperationMap[key];\n    if (typeof operation === 'number') {\n        editTable(editor, operation);\n    }\n}\n\nconst TableEditInsertMenuItem: ContextMenuItem<TableEditInsertMenuItemStringKey> = {\n    key: 'menuNameTableInsert',\n    unlocalizedText: 'Insert',\n    subItems: {\n        menuNameTableInsertAbove: 'Insert above',\n        menuNameTableInsertBelow: 'Insert below',\n        menuNameTableInsertLeft: 'Insert left',\n        menuNameTableInsertRight: 'Insert right',\n    },\n    onClick,\n};\n\nconst TableEditDeleteMenuItem: ContextMenuItem<TableEditDeleteMenuItemStringKey> = {\n    key: 'menuNameTableDelete',\n    unlocalizedText: 'Delete',\n    subItems: {\n        menuNameTableDeleteColumn: 'Delete column',\n        menuNameTableDeleteRow: 'Delete row',\n        menuNameTableDeleteTable: 'Delete table',\n    },\n    onClick,\n};\n\nconst TableEditMergeMenuItem: ContextMenuItem<TableEditMergeMenuItemStringKey> = {\n    key: 'menuNameTableMerge',\n    unlocalizedText: 'Merge',\n    subItems: {\n        menuNameTableMergeAbove: 'Merge above',\n        menuNameTableMergeBelow: 'Merge below',\n        menuNameTableMergeLeft: 'Merge left',\n        menuNameTableMergeRight: 'Merge right',\n        '-': '-',\n        menuNameTableMergeCells: 'Merge selected cells',\n    },\n    onClick,\n};\n\nconst TableEditSplitMenuItem: ContextMenuItem<TableEditSplitMenuItemStringKey> = {\n    key: 'menuNameTableSplit',\n    unlocalizedText: 'Split',\n    subItems: {\n        menuNameTableSplitHorizontally: 'Split horizontally',\n        menuNameTableSplitVertically: 'Split vertically',\n    },\n    onClick,\n};\n\nconst TableEditAlignMenuItem: ContextMenuItem<TableEditAlignMenuItemStringKey> = {\n    key: 'menuNameTableAlign',\n    unlocalizedText: 'Align cell',\n    subItems: {\n        menuNameTableAlignLeft: 'Align left',\n        menuNameTableAlignCenter: 'Align center',\n        menuNameTableAlignRight: 'Align right',\n        '-': '-',\n        menuNameTableAlignTop: 'Align top',\n        menuNameTableAlignMiddle: 'Align middle',\n        menuNameTableAlignBottom: 'Align bottom',\n    },\n    onClick,\n};\n\nconst TableEditAlignTableMenuItem: ContextMenuItem<TableEditAlignTableMenuItemStringKey> = {\n    key: 'menuNameTableAlignTable',\n    unlocalizedText: 'Align table',\n    subItems: {\n        menuNameTableAlignTableLeft: 'Align left',\n        menuNameTableAlignTableCenter: 'Align center',\n        menuNameTableAlignTableRight: 'Align right',\n    },\n    onClick,\n};\n\nconst TableEditCellShadeMenuItem: ContextMenuItem<TableEditShadeMenuItemStringKey> = {\n    key: 'menuNameTableCellShade',\n    unlocalizedText: 'Shading',\n    subItems: BackgroundColorDropDownItems,\n    onClick: (key, editor) => {\n        applyCellShading(editor, ColorValues[key]);\n    },\n    itemRender: (item, click) => renderColorPicker(item, ColorValues, click),\n    itemClassName: getColorPickerItemClassName(),\n    commandBarSubMenuProperties: {\n        className: getColorPickerContainerClassName(),\n    },\n};\n\nfunction getEditingTable(editor: IEditor, node: Node) {\n    const td = editor.getElementAtCursor('TD,TH', node) as HTMLTableCellElement;\n    const table = td && (editor.getElementAtCursor('table', td) as HTMLTableElement);\n\n    return table?.isContentEditable ? { table, td } : null;\n}\n\n/**\n * Create a new instance of ContextMenuProvider to support table editing functionalities in context menu\n * @returns A new ContextMenuProvider\n */\nexport default function createTableEditMenuProvider(\n    strings?: LocalizedStrings<TableEditMenuItemStringKey>\n): EditorPlugin {\n    return createContextMenuProvider(\n        'tableEdit',\n        <ContextMenuItem<TableEditMenuItemStringKey>[]>[\n            TableEditInsertMenuItem,\n            TableEditDeleteMenuItem,\n            TableEditMergeMenuItem,\n            TableEditSplitMenuItem,\n            TableEditAlignMenuItem,\n            TableEditAlignTableMenuItem,\n            TableEditCellShadeMenuItem,\n        ],\n        strings,\n        (editor, node) => !!getEditingTable(editor, node)\n    );\n}\n"]}