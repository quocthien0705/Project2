{"version":3,"file":"insertLink.js","sourceRoot":"","sources":["../../../../../../packages/roosterjs-react/lib/ribbon/component/buttons/insertLink.ts"],"names":[],"mappings":";;;AAAA,8EAAyE;AACzE,6DAAkD;AAKlD;;;GAGG;AACU,QAAA,UAAU,GAA4C;IAC/D,GAAG,EAAE,sBAAsB;IAC3B,eAAe,EAAE,aAAa;IAC9B,QAAQ,EAAE,MAAM;IAChB,UAAU,EAAE,UAAA,WAAW,IAAI,OAAA,CAAC,CAAC,WAAW,CAAC,oBAAoB,EAAlC,CAAkC;IAC7D,OAAO,EAAE,UAAC,MAAM,EAAE,CAAC,EAAE,OAAO,EAAE,WAAW;;QACrC,IAAM,YAAY,GAAG,MAAM,CAAC,aAAa,CACrC,SAAS,sBAEZ,CAAC,CAAC,CAAC,CAAC;QACL,IAAM,GAAG,GAAG,CAAA,YAAY,aAAZ,YAAY,uBAAZ,YAAY,CAAE,IAAI,KAAI,EAAE,CAAC;QACrC,IAAM,WAAW,GACb,CAAA,YAAY,aAAZ,YAAY,uBAAZ,YAAY,CAAE,WAAW,MAAI,MAAA,MAAM,CAAC,iBAAiB,EAAE,0CAAE,QAAQ,EAAE,CAAA,IAAI,EAAE,CAAC;QAC9E,IAAM,KAAK,GAAG;YACV,GAAG,EAAE;gBACD,SAAS,EAAE,IAAI;gBACf,QAAQ,EAAE,qBAA8B;gBACxC,gBAAgB,EAAE,mBAAmB;gBACrC,SAAS,EAAE,GAAG;aACjB;YACD,WAAW,EAAE;gBACT,QAAQ,EAAE,2BAAoC;gBAC9C,gBAAgB,EAAE,YAAY;gBAC9B,SAAS,EAAE,WAAW;aACzB;SACJ,CAAC;QAEF,IAAA,yBAAe,EACX,WAAW,EACX,iBAAiB,EACjB,aAAa,EACb,KAAK,EACL,OAAO,EACP,UAAC,QAAQ,EAAE,QAAQ,EAAE,MAAM;YACvB,IAAI,QAAQ,IAAI,KAAK,IAAI,MAAM,CAAC,WAAW,IAAI,MAAM,CAAC,GAAG,EAAE;gBACvD,MAAM,CAAC,WAAW,GAAG,QAAQ,CAAC;gBAC9B,MAAM,CAAC,GAAG,GAAG,QAAQ,CAAC;gBACtB,OAAO,MAAM,CAAC;aACjB;iBAAM;gBACH,OAAO,IAAI,CAAC;aACf;QACL,CAAC,CACJ,CAAC,IAAI,CAAC,UAAA,MAAM;YACT,MAAM,CAAC,KAAK,EAAE,CAAC;YAEf,IACI,MAAM;gBACN,MAAM,CAAC,WAAW;gBAClB,MAAM,CAAC,GAAG;gBACV,CAAC,MAAM,CAAC,WAAW,IAAI,WAAW,IAAI,MAAM,CAAC,GAAG,IAAI,GAAG,CAAC,EAC1D;gBACE,IAAA,iCAAU,EAAC,MAAM,EAAE,MAAM,CAAC,GAAG,EAAE,MAAM,CAAC,GAAG,EAAE,MAAM,CAAC,WAAW,CAAC,CAAC;aAClE;QACL,CAAC,CAAC,CAAC;IACP,CAAC;CACJ,CAAC","sourcesContent":["import showInputDialog from '../../../inputDialog/utils/showInputDialog';\nimport { createLink } from 'roosterjs-editor-api';\nimport { QueryScope } from 'roosterjs-editor-types';\nimport type RibbonButton from '../../type/RibbonButton';\nimport type { InsertLinkButtonStringKey } from '../../type/RibbonButtonStringKeys';\n\n/**\n * @internal\n * \"Insert link\" button on the format ribbon\n */\nexport const insertLink: RibbonButton<InsertLinkButtonStringKey> = {\n    key: 'buttonNameInsertLink',\n    unlocalizedText: 'Insert link',\n    iconName: 'Link',\n    isDisabled: formatState => !!formatState.isMultilineSelection,\n    onClick: (editor, _, strings, uiUtilities) => {\n        const existingLink = editor.queryElements<HTMLAnchorElement>(\n            'a[href]',\n            QueryScope.OnSelection\n        )[0];\n        const url = existingLink?.href || '';\n        const displayText =\n            existingLink?.textContent || editor.getSelectionRange()?.toString() || '';\n        const items = {\n            url: {\n                autoFocus: true,\n                labelKey: 'insertLinkDialogUrl' as const,\n                unlocalizedLabel: 'Web address (URL)',\n                initValue: url,\n            },\n            displayText: {\n                labelKey: 'insertLinkDialogDisplayAs' as const,\n                unlocalizedLabel: 'Display as',\n                initValue: displayText,\n            },\n        };\n\n        showInputDialog(\n            uiUtilities,\n            'insertLinkTitle',\n            'Insert link',\n            items,\n            strings,\n            (itemName, newValue, values) => {\n                if (itemName == 'url' && values.displayText == values.url) {\n                    values.displayText = newValue;\n                    values.url = newValue;\n                    return values;\n                } else {\n                    return null;\n                }\n            }\n        ).then(result => {\n            editor.focus();\n\n            if (\n                result &&\n                result.displayText &&\n                result.url &&\n                (result.displayText != displayText || result.url != url)\n            ) {\n                createLink(editor, result.url, result.url, result.displayText);\n            }\n        });\n    },\n};\n"]}