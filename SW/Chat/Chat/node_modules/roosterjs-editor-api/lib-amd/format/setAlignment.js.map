{"version":3,"file":"setAlignment.js","sourceRoot":"","sources":["../../../../packages/roosterjs-editor-api/lib/format/setAlignment.ts"],"names":[],"mappings":";;;IAoBA;;;;;OAKG;IACH,SAAwB,YAAY,CAAC,MAAe,EAAE,SAA0C;QAC5F,IAAA,4BAAkB,EACd,MAAM,EACN;YACI,IAAM,SAAS,GAAG,MAAM,CAAC,mBAAmB,EAAE,CAAC;YAC/C,IAAM,QAAQ,GAAG,SAAS,IAAI,SAAS,CAAC,IAAI,2BAAuC,CAAC;YACpF,IAAM,eAAe,GAAG,MAAM,CAAC,kBAAkB,EAAE,CAAC;YAEpD,IACI,QAAQ;gBACR,SAAS,CAAC,WAAW;gBACrB,IAAA,2CAAoB,EAAC,IAAI,6BAAM,CAAC,SAAS,CAAC,KAAK,CAAC,EAAE,SAAS,CAAC,WAAW,CAAC,EAC1E;gBACE,UAAU,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;aACpC;iBAAM,IAAI,eAAe,IAAI,MAAM,CAAC,eAAe,CAAC,EAAE;gBACnD,SAAS,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;aAChC;iBAAM;gBACH,SAAS,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;aAChC;QACL,CAAC,EACD,cAAc,CACjB,CAAC;IACN,CAAC;IAtBD,+BAsBC;IAED;;;;;;;OAOG;IACH,SAAS,UAAU,CAAC,SAA8B,EAAE,SAA0C;QAC1F,IAAM,KAAK,GAAG,SAAS,CAAC,KAAK,CAAC;QAC9B,IAAI,SAAS,kBAAoB,EAAE;YAC/B,KAAK,CAAC,KAAK,CAAC,UAAU,GAAG,MAAM,CAAC;YAChC,KAAK,CAAC,KAAK,CAAC,WAAW,GAAG,MAAM,CAAC;SACpC;aAAM,IAAI,SAAS,iBAAmB,EAAE;YACrC,KAAK,CAAC,KAAK,CAAC,UAAU,GAAG,MAAM,CAAC;YAChC,KAAK,CAAC,KAAK,CAAC,WAAW,GAAG,EAAE,CAAC;SAChC;aAAM;YACH,KAAK,CAAC,KAAK,CAAC,UAAU,GAAG,EAAE,CAAC;YAC5B,KAAK,CAAC,KAAK,CAAC,WAAW,GAAG,MAAM,CAAC;SACpC;IACL,CAAC;IAED;;;;;OAKG;IACH,SAAS,SAAS,CAAC,MAAe,EAAE,SAA0C;QAC1E,IAAI,KAAK,GAAG,MAAM,CAAC;QACnB,IAAI,OAAO,kCAA8B,CAAC;QAC1C,IAAI,SAAS,kBAAoB,EAAE;YAC/B,OAAO,sCAAgC,CAAC;YACxC,KAAK,GAAG,QAAQ,CAAC;SACpB;aAAM,IAAI,SAAS,iBAAmB,EAAE;YACrC,OAAO,oCAA+B,CAAC;YACvC,KAAK,GAAG,OAAO,CAAC;SACnB;QACD,IAAA,qBAAW,EAAC,MAAM,EAAE,OAAO,CAAC,CAAC;QAC7B,IAAM,QAAQ,GAAG,MAAM,CAAC,aAAa,CAAC,SAAS,uBAA0B,UAAA,IAAI;YACzE,IAAI,CAAC,KAAK,CAAC,SAAS,GAAG,KAAK,CAAC;YAC7B,IAAA,6BAAmB,EAAC,IAAI,CAAC,CAAC;QAC9B,CAAC,CAAC,CAAC;QAEH,IAAI,QAAQ,CAAC,MAAM,IAAI,CAAC,EAAE;YACtB,IAAM,IAAI,GAAG,MAAM,CAAC,kBAAkB,EAAE,CAAC;YACzC,IAAI,IAAI,EAAE;gBACN,IAAA,6BAAmB,EAAC,IAAI,CAAC,CAAC;aAC7B;SACJ;IACL,CAAC;IAED,SAAS,MAAM,CAAC,OAAoB;QAChC,OAAO,IAAA,iDAA0B,EAAC,OAAO,EAAE,SAAS,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC;IAC5E,CAAC;IAED,SAAS,SAAS,CAAC,MAAe,EAAE,SAA0C;QAC1E,IAAA,qBAAW,EACP,MAAM,EACN,UAAC,MAAM,EAAE,KAAK,EAAE,GAAG;YACf,IAAM,MAAM,GAAG,IAAA,uDAAgC,EAAC,MAAM,CAAC,CAAC;YACxD,IAAM,SAAS,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC,YAAY,EAAE,CAAC;YAC3C,IAAM,KAAK,GAAG,IAAA,4CAAqB,EAAC,MAAM,EAAE,IAAI,CAAC,uBAAuB,EAAE,SAAS,CAAC,CAAC;YACrF,IAAI,KAAK,IAAI,GAAG,EAAE;gBACd,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,YAAY,CAAC,KAAK,EAAE,GAAG,EAAE,SAAS,CAAC,CAAC;aAC9C;QACL,CAAC,EACD,SAAS,CAAC,uBAAuB,EACjC,WAAW,CACd,CAAC;IACN,CAAC","sourcesContent":["import blockFormat from '../utils/blockFormat';\r\nimport execCommand from '../utils/execCommand';\r\nimport formatUndoSnapshot from '../utils/formatUndoSnapshot';\r\nimport normalizeBlockquote from '../utils/normalizeBlockquote';\r\nimport {\r\n    Alignment,\r\n    DocumentCommand,\r\n    QueryScope,\r\n    SelectionRangeTypes,\r\n} from 'roosterjs-editor-types';\r\nimport {\r\n    createVListFromRegion,\r\n    findClosestElementAncestor,\r\n    getSelectedBlockElementsInRegion,\r\n    isWholeTableSelected,\r\n    VTable,\r\n} from 'roosterjs-editor-dom';\r\nimport type { IEditor, TableSelectionRange } from 'roosterjs-editor-types';\r\nimport type { CompatibleAlignment } from 'roosterjs-editor-types/lib/compatibleTypes';\r\n\r\n/**\r\n * Set content alignment\r\n * @param editor The editor instance\r\n * @param alignment The alignment option:\r\n * Alignment.Center, Alignment.Left, Alignment.Right\r\n */\r\nexport default function setAlignment(editor: IEditor, alignment: Alignment | CompatibleAlignment) {\r\n    formatUndoSnapshot(\r\n        editor,\r\n        () => {\r\n            const selection = editor.getSelectionRangeEx();\r\n            const isATable = selection && selection.type === SelectionRangeTypes.TableSelection;\r\n            const elementAtCursor = editor.getElementAtCursor();\r\n\r\n            if (\r\n                isATable &&\r\n                selection.coordinates &&\r\n                isWholeTableSelected(new VTable(selection.table), selection.coordinates)\r\n            ) {\r\n                alignTable(selection, alignment);\r\n            } else if (elementAtCursor && isList(elementAtCursor)) {\r\n                alignList(editor, alignment);\r\n            } else {\r\n                alignText(editor, alignment);\r\n            }\r\n        },\r\n        'setAlignment'\r\n    );\r\n}\r\n\r\n/**\r\n * Align text using the margins\r\n * @param editor\r\n * @param element\r\n * @param alignment\r\n * @param addUndoSnapshot\r\n * @returns\r\n */\r\nfunction alignTable(selection: TableSelectionRange, alignment: Alignment | CompatibleAlignment) {\r\n    const table = selection.table;\r\n    if (alignment == Alignment.Center) {\r\n        table.style.marginLeft = 'auto';\r\n        table.style.marginRight = 'auto';\r\n    } else if (alignment == Alignment.Right) {\r\n        table.style.marginLeft = 'auto';\r\n        table.style.marginRight = '';\r\n    } else {\r\n        table.style.marginLeft = '';\r\n        table.style.marginRight = 'auto';\r\n    }\r\n}\r\n\r\n/**\r\n * Align text using the text-align\r\n * @param editor\r\n * @param alignment\r\n * @returns\r\n */\r\nfunction alignText(editor: IEditor, alignment: Alignment | CompatibleAlignment) {\r\n    let align = 'left';\r\n    let command = DocumentCommand.JustifyLeft;\r\n    if (alignment == Alignment.Center) {\r\n        command = DocumentCommand.JustifyCenter;\r\n        align = 'center';\r\n    } else if (alignment == Alignment.Right) {\r\n        command = DocumentCommand.JustifyRight;\r\n        align = 'right';\r\n    }\r\n    execCommand(editor, command);\r\n    const elements = editor.queryElements('[align]', QueryScope.OnSelection, node => {\r\n        node.style.textAlign = align;\r\n        normalizeBlockquote(node);\r\n    });\r\n\r\n    if (elements.length == 0) {\r\n        const node = editor.getElementAtCursor();\r\n        if (node) {\r\n            normalizeBlockquote(node);\r\n        }\r\n    }\r\n}\r\n\r\nfunction isList(element: HTMLElement) {\r\n    return findClosestElementAncestor(element, undefined /** root */, 'LI');\r\n}\r\n\r\nfunction alignList(editor: IEditor, alignment: Alignment | CompatibleAlignment) {\r\n    blockFormat(\r\n        editor,\r\n        (region, start, end) => {\r\n            const blocks = getSelectedBlockElementsInRegion(region);\r\n            const startNode = blocks[0].getStartNode();\r\n            const vList = createVListFromRegion(region, true /*includeSiblingLists*/, startNode);\r\n            if (start && end) {\r\n                vList?.setAlignment(start, end, alignment);\r\n            }\r\n        },\r\n        undefined /* beforeRunCallback */,\r\n        'alignList'\r\n    );\r\n}\r\n"]}