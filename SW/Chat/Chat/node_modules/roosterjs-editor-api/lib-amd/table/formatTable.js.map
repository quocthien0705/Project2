{"version":3,"file":"formatTable.js","sourceRoot":"","sources":["../../../../packages/roosterjs-editor-api/lib/table/formatTable.ts"],"names":[],"mappings":";;;IAIA;;;;;OAKG;IACH,SAAwB,WAAW,CAC/B,MAAe,EACf,MAAmB,EACnB,KAAwB;QAExB,KAAK,GAAG,KAAK,IAAK,MAAM,CAAC,kBAAkB,CAAC,OAAO,CAAsB,CAAC;QAC1E,IAAI,KAAK,EAAE;YACP,IAAA,4BAAkB,EACd,MAAM,EACN,UAAC,KAAK,EAAE,GAAG;gBACP,IAAI,CAAC,KAAK,EAAE;oBACR,OAAO;iBACV;gBAED,IAAM,MAAM,GAAG,IAAI,6BAAM,CAAC,KAAK,CAAC,CAAC;gBACjC,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;gBAC3B,MAAM,CAAC,SAAS,CAAC,KAAK,CAAC,sBAAsB,EAAE,MAAM,CAAC,mBAAmB,EAAE,CAAC,CAAC;gBAC7E,MAAM,CAAC,oBAAoB,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;gBAC1C,MAAM,CAAC,KAAK,EAAE,CAAC;gBACf,IAAI,KAAK,IAAI,GAAG,EAAE;oBACd,MAAM,CAAC,MAAM,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;iBAC7B;YACL,CAAC,EACD,aAAa,CAChB,CAAC;SACL;IACL,CAAC;IA1BD,8BA0BC","sourcesContent":["import formatUndoSnapshot from '../utils/formatUndoSnapshot';\r\nimport { VTable } from 'roosterjs-editor-dom';\r\nimport type { IEditor, TableFormat } from 'roosterjs-editor-types';\r\n\r\n/**\r\n * Format table\r\n * @param editor The editor which contains the table to format\r\n * @param format A TableFormat object contains format information we want to apply to the table\r\n * @param table The table to format. This is optional. When not passed, the current table (if any) will be formatted\r\n */\r\nexport default function formatTable(\r\n    editor: IEditor,\r\n    format: TableFormat,\r\n    table?: HTMLTableElement\r\n) {\r\n    table = table || (editor.getElementAtCursor('TABLE') as HTMLTableElement);\r\n    if (table) {\r\n        formatUndoSnapshot(\r\n            editor,\r\n            (start, end) => {\r\n                if (!table) {\r\n                    return;\r\n                }\r\n\r\n                const vtable = new VTable(table);\r\n                vtable.applyFormat(format);\r\n                vtable.writeBack(false /** skipApplyFormat */, editor.getDarkColorHandler());\r\n                editor.transformToDarkColor(vtable.table);\r\n                editor.focus();\r\n                if (start && end) {\r\n                    editor.select(start, end);\r\n                }\r\n            },\r\n            'formatTable'\r\n        );\r\n    }\r\n}\r\n"]}