{"version":3,"file":"insertImage.js","sourceRoot":"","sources":["../../../../packages/roosterjs-editor-api/lib/format/insertImage.ts"],"names":[],"mappings":"AAAA,OAAO,kBAAkB,MAAM,6BAA6B,CAAC;AAC7D,OAAO,EAAE,aAAa,EAAE,QAAQ,EAAE,MAAM,sBAAsB,CAAC;AAG/D;;;;;GAKG;AACH,MAAM,CAAC,OAAO,UAAU,WAAW,CAC/B,MAAe,EACf,cAA6B,EAC7B,UAAmC;IAEnC,IAAI,OAAO,cAAc,IAAI,QAAQ,EAAE;QACnC,kBAAkB,CAAC,MAAM,EAAE,cAAc,EAAE,UAAU,CAAC,CAAC;KAC1D;SAAM;QACH,QAAQ,CAAC,cAAc,EAAE,UAAA,OAAO;YAC5B,IAAI,OAAO,IAAI,CAAC,MAAM,CAAC,UAAU,EAAE,EAAE;gBACjC,kBAAkB,CAAC,MAAM,EAAE,OAAO,EAAE,UAAU,CAAC,CAAC;aACnD;QACL,CAAC,CAAC,CAAC;KACN;AACL,CAAC;AAED,SAAS,kBAAkB,CAAC,MAAe,EAAE,GAAW,EAAE,UAAmC;IACzF,kBAAkB,CACd,MAAM,EACN;QACI,IAAM,KAAK,GAAG,MAAM,CAAC,WAAW,EAAE,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QACxD,KAAK,CAAC,GAAG,GAAG,GAAG,CAAC;QAEhB,IAAI,UAAU,EAAE;YACZ,aAAa,CAAC,UAAU,CAAC,CAAC,OAAO,CAAC,UAAA,SAAS;gBACvC,OAAA,KAAK,CAAC,YAAY,CAAC,SAAS,EAAE,UAAU,CAAC,SAAS,CAAC,CAAC;YAApD,CAAoD,CACvD,CAAC;SACL;QACD,MAAM,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;IAC7B,CAAC,EACD,aAAa,CAChB,CAAC;AACN,CAAC","sourcesContent":["import formatUndoSnapshot from '../utils/formatUndoSnapshot';\r\nimport { getObjectKeys, readFile } from 'roosterjs-editor-dom';\r\nimport type { IEditor } from 'roosterjs-editor-types';\r\n\r\n/**\r\n * Insert an image to editor at current selection\r\n * @param editor The editor instance\r\n * @param imageFileOrSrc Either the image file blob or source string of the image.\r\n * @param attributes Optional image element attributes\r\n */\r\nexport default function insertImage(\r\n    editor: IEditor,\r\n    imageFileOrSrc: File | string,\r\n    attributes?: Record<string, string>\r\n): void {\r\n    if (typeof imageFileOrSrc == 'string') {\r\n        insertImageWithSrc(editor, imageFileOrSrc, attributes);\r\n    } else {\r\n        readFile(imageFileOrSrc, dataUrl => {\r\n            if (dataUrl && !editor.isDisposed()) {\r\n                insertImageWithSrc(editor, dataUrl, attributes);\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\nfunction insertImageWithSrc(editor: IEditor, src: string, attributes?: Record<string, string>) {\r\n    formatUndoSnapshot(\r\n        editor,\r\n        () => {\r\n            const image = editor.getDocument().createElement('img');\r\n            image.src = src;\r\n\r\n            if (attributes) {\r\n                getObjectKeys(attributes).forEach(attribute =>\r\n                    image.setAttribute(attribute, attributes[attribute])\r\n                );\r\n            }\r\n            editor.insertNode(image);\r\n        },\r\n        'insertImage'\r\n    );\r\n}\r\n"]}