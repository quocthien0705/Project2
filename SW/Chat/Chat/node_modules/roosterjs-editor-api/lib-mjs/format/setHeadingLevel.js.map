{"version":3,"file":"setHeadingLevel.js","sourceRoot":"","sources":["../../../../packages/roosterjs-editor-api/lib/format/setHeadingLevel.ts"],"names":[],"mappings":"AAAA,OAAO,kBAAkB,MAAM,6BAA6B,CAAC;AAE7D,OAAO,EAAE,aAAa,EAAE,cAAc,EAAE,MAAM,sBAAsB,CAAC;AAGrE;;;;;;GAMG;AACH,MAAM,CAAC,OAAO,UAAU,eAAe,CAAC,MAAe,EAAE,KAAa;IAClE,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;IAEpD,kBAAkB,CACd,MAAM,EACN;QACI,MAAM,CAAC,KAAK,EAAE,CAAC;QAEf,IAAI,OAAO,GAAG,KAAK,CAAC;QACpB,MAAM,CAAC,aAAa,CAAC,mBAAmB,uBAA0B,UAAA,OAAO;YACrE,IAAI,CAAC,OAAO,EAAE;gBACV,MAAM,CAAC,WAAW,EAAE,CAAC,WAAW,kCAA8B,KAAK,EAAE,OAAO,CAAC,CAAC;gBAC9E,OAAO,GAAG,IAAI,CAAC;aAClB;YAED,IAAM,GAAG,GAAG,MAAM,CAAC,WAAW,EAAE,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;YACtD,cAAc,CAAC,GAAG,EAAE,OAAO,CAAC,CAAC;YAC7B,MAAM,CAAC,WAAW,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC;QACrC,CAAC,CAAC,CAAC;QAEH,IAAI,KAAK,GAAG,CAAC,EAAE;YACX,IAAM,SAAS,GAAG,MAAM,CAAC,qBAAqB,EAAE,CAAC;YACjD,IAAI,YAAY,GAAG,SAAS,aAAT,SAAS,uBAAT,SAAS,CAAE,mBAAmB,CAAC;YAClD,IAAM,SAAS,GAAG,IAAI,aAAa,CAAC;gBAChC,iBAAiB,EAAE;oBACf,WAAW,EAAE,cAAM,OAAA,KAAK,EAAL,CAAK;iBAC3B;aACJ,CAAC,CAAC;YACH,OAAO,YAAY,EAAE;gBACjB,IAAM,OAAO,GAAG,YAAY,CAAC,uBAAuB,EAAE,CAAC;gBACvD,SAAS,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;gBAC5B,YAAY,GAAG,SAAS,aAAT,SAAS,uBAAT,SAAS,CAAE,mBAAmB,EAAE,CAAC;aACnD;YACD,MAAM,CAAC,WAAW,EAAE,CAAC,WAAW,kCAA8B,KAAK,EAAE,OAAK,KAAK,MAAG,CAAC,CAAC;SACvF;IACL,CAAC,EACD,cAAc,CACjB,CAAC;AACN,CAAC;AAED;;;GAGG;AACH,MAAM,CAAC,IAAM,YAAY,GAAG,eAAe,CAAC","sourcesContent":["import formatUndoSnapshot from '../utils/formatUndoSnapshot';\nimport { DocumentCommand, QueryScope } from 'roosterjs-editor-types';\nimport { HtmlSanitizer, moveChildNodes } from 'roosterjs-editor-dom';\nimport type { IEditor } from 'roosterjs-editor-types';\n\n/**\n * Set heading level at selection\n * @param editor The editor instance\n * @param level The heading level, can be a number from 0 to 6, in which 1 ~ 6 refers to\n * the HTML heading element &lt;H1&gt; to &lt;H6&gt;, 0 means no heading\n * if passed in param is outside the range, will be rounded to nearest number in the range\n */\nexport default function setHeadingLevel(editor: IEditor, level: number) {\n    level = Math.min(Math.max(Math.round(level), 0), 6);\n\n    formatUndoSnapshot(\n        editor,\n        () => {\n            editor.focus();\n\n            let wrapped = false;\n            editor.queryElements('H1,H2,H3,H4,H5,H6', QueryScope.OnSelection, heading => {\n                if (!wrapped) {\n                    editor.getDocument().execCommand(DocumentCommand.FormatBlock, false, '<DIV>');\n                    wrapped = true;\n                }\n\n                const div = editor.getDocument().createElement('div');\n                moveChildNodes(div, heading);\n                editor.replaceNode(heading, div);\n            });\n\n            if (level > 0) {\n                const traverser = editor.getSelectionTraverser();\n                let blockElement = traverser?.currentBlockElement;\n                const sanitizer = new HtmlSanitizer({\n                    cssStyleCallbacks: {\n                        'font-size': () => false,\n                    },\n                });\n                while (blockElement) {\n                    const element = blockElement.collapseToSingleElement();\n                    sanitizer.sanitize(element);\n                    blockElement = traverser?.getNextBlockElement();\n                }\n                editor.getDocument().execCommand(DocumentCommand.FormatBlock, false, `<H${level}>`);\n            }\n        },\n        'toggleHeader'\n    );\n}\n\n/**\n * @deprecated Use setHeadingLevel instead\n * Keep this for compatibility only, will be removed in next major release\n */\nexport const toggleHeader = setHeadingLevel;\n"]}