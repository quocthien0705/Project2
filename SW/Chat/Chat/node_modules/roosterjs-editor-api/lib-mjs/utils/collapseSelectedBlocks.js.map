{"version":3,"file":"collapseSelectedBlocks.js","sourceRoot":"","sources":["../../../../packages/roosterjs-editor-api/lib/utils/collapseSelectedBlocks.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,YAAY,EAAE,MAAM,sBAAsB,CAAC;AAIpD;;;;;GAKG;AACH,MAAM,CAAC,OAAO,UAAU,sBAAsB,CAC1C,MAAe,EACf,eAA8C;IAE9C,IAAM,SAAS,GAAG,MAAM,CAAC,qBAAqB,EAAE,CAAC;IACjD,IAAI,CAAC,SAAS,EAAE;QACZ,OAAO;KACV;IACD,IAAI,KAAK,GAAG,SAAS,CAAC,mBAAmB,CAAC;IAC1C,IAAM,MAAM,GAAmB,EAAE,CAAC;IAClC,OAAO,KAAK,EAAE;QACV,IAAI,CAAC,mBAAmB,CAAC,KAAK,CAAC,EAAE;YAC7B,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;SACtB;QACD,KAAK,GAAG,SAAS,CAAC,mBAAmB,EAAE,CAAC;KAC3C;IAED,MAAM,CAAC,OAAO,CAAC,UAAA,KAAK;QAChB,IAAM,OAAO,GAAG,KAAK,CAAC,uBAAuB,EAAE,CAAC;QAChD,eAAe,CAAC,OAAO,CAAC,CAAC;IAC7B,CAAC,CAAC,CAAC;AACP,CAAC;AAED,SAAS,mBAAmB,CAAC,KAAmB;IAC5C,IAAM,SAAS,GAAG,KAAK,CAAC,YAAY,EAAE,CAAC;IAEvC,OAAO,CACH,SAAS,IAAI,KAAK,CAAC,UAAU,EAAE;QAC/B,SAAS,CAAC,QAAQ,gBAAiB;QACnC,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC,OAAO,CAAC,YAAY,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC,IAAI,CAAC,CACnE,CAAC;AACN,CAAC","sourcesContent":["import { getTagOfNode } from 'roosterjs-editor-dom';\r\nimport { NodeType } from 'roosterjs-editor-types';\r\nimport type { BlockElement, IEditor } from 'roosterjs-editor-types';\r\n\r\n/**\r\n * @internal\r\n * Collapse all selected blocks, return single HTML elements for each block\r\n * @param editor The editor instance\r\n * @param forEachCallback A callback function to invoke for each of the collapsed element\r\n */\r\nexport default function collapseSelectedBlocks(\r\n    editor: IEditor,\r\n    forEachCallback: (element: HTMLElement) => any\r\n) {\r\n    const traverser = editor.getSelectionTraverser();\r\n    if (!traverser) {\r\n        return;\r\n    }\r\n    let block = traverser.currentBlockElement;\r\n    const blocks: BlockElement[] = [];\r\n    while (block) {\r\n        if (!isEmptyBlockUnderTR(block)) {\r\n            blocks.push(block);\r\n        }\r\n        block = traverser.getNextBlockElement();\r\n    }\r\n\r\n    blocks.forEach(block => {\r\n        const element = block.collapseToSingleElement();\r\n        forEachCallback(element);\r\n    });\r\n}\r\n\r\nfunction isEmptyBlockUnderTR(block: BlockElement): boolean {\r\n    const startNode = block.getStartNode();\r\n\r\n    return (\r\n        startNode == block.getEndNode() &&\r\n        startNode.nodeType == NodeType.Text &&\r\n        ['TR', 'TABLE'].indexOf(getTagOfNode(startNode.parentNode)) >= 0\r\n    );\r\n}\r\n"]}