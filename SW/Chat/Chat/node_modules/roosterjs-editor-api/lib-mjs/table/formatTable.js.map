{"version":3,"file":"formatTable.js","sourceRoot":"","sources":["../../../../packages/roosterjs-editor-api/lib/table/formatTable.ts"],"names":[],"mappings":"AAAA,OAAO,kBAAkB,MAAM,6BAA6B,CAAC;AAC7D,OAAO,EAAE,MAAM,EAAE,MAAM,sBAAsB,CAAC;AAG9C;;;;;GAKG;AACH,MAAM,CAAC,OAAO,UAAU,WAAW,CAC/B,MAAe,EACf,MAAmB,EACnB,KAAwB;IAExB,KAAK,GAAG,KAAK,IAAK,MAAM,CAAC,kBAAkB,CAAC,OAAO,CAAsB,CAAC;IAC1E,IAAI,KAAK,EAAE;QACP,kBAAkB,CACd,MAAM,EACN,UAAC,KAAK,EAAE,GAAG;YACP,IAAI,CAAC,KAAK,EAAE;gBACR,OAAO;aACV;YAED,IAAM,MAAM,GAAG,IAAI,MAAM,CAAC,KAAK,CAAC,CAAC;YACjC,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;YAC3B,MAAM,CAAC,SAAS,CAAC,KAAK,CAAC,sBAAsB,EAAE,MAAM,CAAC,mBAAmB,EAAE,CAAC,CAAC;YAC7E,MAAM,CAAC,oBAAoB,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;YAC1C,MAAM,CAAC,KAAK,EAAE,CAAC;YACf,IAAI,KAAK,IAAI,GAAG,EAAE;gBACd,MAAM,CAAC,MAAM,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;aAC7B;QACL,CAAC,EACD,aAAa,CAChB,CAAC;KACL;AACL,CAAC","sourcesContent":["import formatUndoSnapshot from '../utils/formatUndoSnapshot';\r\nimport { VTable } from 'roosterjs-editor-dom';\r\nimport type { IEditor, TableFormat } from 'roosterjs-editor-types';\r\n\r\n/**\r\n * Format table\r\n * @param editor The editor which contains the table to format\r\n * @param format A TableFormat object contains format information we want to apply to the table\r\n * @param table The table to format. This is optional. When not passed, the current table (if any) will be formatted\r\n */\r\nexport default function formatTable(\r\n    editor: IEditor,\r\n    format: TableFormat,\r\n    table?: HTMLTableElement\r\n) {\r\n    table = table || (editor.getElementAtCursor('TABLE') as HTMLTableElement);\r\n    if (table) {\r\n        formatUndoSnapshot(\r\n            editor,\r\n            (start, end) => {\r\n                if (!table) {\r\n                    return;\r\n                }\r\n\r\n                const vtable = new VTable(table);\r\n                vtable.applyFormat(format);\r\n                vtable.writeBack(false /** skipApplyFormat */, editor.getDarkColorHandler());\r\n                editor.transformToDarkColor(vtable.table);\r\n                editor.focus();\r\n                if (start && end) {\r\n                    editor.select(start, end);\r\n                }\r\n            },\r\n            'formatTable'\r\n        );\r\n    }\r\n}\r\n"]}