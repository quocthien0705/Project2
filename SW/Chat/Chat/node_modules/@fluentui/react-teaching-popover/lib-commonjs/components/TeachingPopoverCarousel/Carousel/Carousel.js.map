{"version":3,"sources":["Carousel.js"],"sourcesContent":["import { isHTMLElement, useMergedRefs, useControllableState, useEventCallback } from '@fluentui/react-utilities';\nimport * as React from 'react';\nimport { CAROUSEL_ITEM } from './constants';\nimport { useCarouselWalker_unstable } from './useCarouselWalker';\nimport { createCarouselStore } from './createCarouselStore';\n// TODO: Migrate this into an external @fluentui/carousel component\n// For now, we won't export this publicly, is only for internal TeachingPopover use until stabilized.\nexport function useCarousel_unstable(options) {\n    const { onValueChange, onFinish } = options;\n    const { ref: carouselRef, walker: carouselWalker } = useCarouselWalker_unstable();\n    const [store] = React.useState(()=>createCarouselStore());\n    const [value, setValue] = useControllableState({\n        defaultState: options.defaultValue,\n        state: options.value,\n        initialState: null\n    });\n    const rootRef = React.useRef(null);\n    if (process.env.NODE_ENV !== 'production') {\n        // eslint-disable-next-line react-hooks/rules-of-hooks\n        React.useEffect(()=>{\n            if (value === null) {\n                // eslint-disable-next-line no-console\n                console.error('useCarousel: Carousel needs to have a `defaultValue` or `value` prop set. If you want to control the value, use the `value` prop.');\n            }\n        }, [\n            value\n        ]);\n    }\n    React.useEffect(()=>{\n        var _rootRef_current;\n        const allItems = (_rootRef_current = rootRef.current) === null || _rootRef_current === void 0 ? void 0 : _rootRef_current.querySelectorAll(`[${CAROUSEL_ITEM}]`);\n        for(let i = 0; i < allItems.length; i++){\n            store.addValue(allItems.item(i).getAttribute(CAROUSEL_ITEM));\n        }\n        return ()=>{\n            store.clear();\n        };\n    }, [\n        store\n    ]);\n    React.useEffect(()=>{\n        const config = {\n            attributes: true,\n            attributeFilter: [\n                CAROUSEL_ITEM\n            ],\n            childList: true,\n            subtree: true\n        };\n        // Callback function to execute when mutations are observed\n        const callback = (mutationList)=>{\n            for (const mutation of mutationList){\n                for (const addedNode of Array.from(mutation.addedNodes)){\n                    if (isHTMLElement(addedNode) && addedNode.hasAttribute(CAROUSEL_ITEM)) {\n                        const newValue = addedNode.getAttribute(CAROUSEL_ITEM);\n                        const newNode = carouselWalker.find(newValue);\n                        if (!(newNode === null || newNode === void 0 ? void 0 : newNode.value)) {\n                            return;\n                        }\n                        const previousNode = carouselWalker.prevPage(newNode === null || newNode === void 0 ? void 0 : newNode.value);\n                        var _previousNode_value;\n                        store.insertValue(newValue, (_previousNode_value = previousNode === null || previousNode === void 0 ? void 0 : previousNode.value) !== null && _previousNode_value !== void 0 ? _previousNode_value : null);\n                    }\n                }\n                for (const removedNode of Array.from(mutation.removedNodes)){\n                    if (isHTMLElement(removedNode) && (removedNode === null || removedNode === void 0 ? void 0 : removedNode.hasAttribute(CAROUSEL_ITEM))) {\n                        const removedValue = removedNode.getAttribute(CAROUSEL_ITEM);\n                        store.removeValue(removedValue);\n                    }\n                }\n            }\n        };\n        // Create an observer instance linked to the callback function\n        const observer = new MutationObserver(callback);\n        // Start observing the target node for configured mutations\n        observer.observe(rootRef.current, config);\n        // Later, you can stop observing\n        return ()=>{\n            observer.disconnect();\n        };\n    }, [\n        carouselWalker,\n        store\n    ]);\n    const selectPageByDirection = useEventCallback((event, direction)=>{\n        const active = carouselWalker.active();\n        if (!(active === null || active === void 0 ? void 0 : active.value)) {\n            return;\n        }\n        const newPage = direction === 'prev' ? carouselWalker.prevPage(active.value) : carouselWalker.nextPage(active.value);\n        if (newPage) {\n            setValue(newPage === null || newPage === void 0 ? void 0 : newPage.value);\n            onValueChange === null || onValueChange === void 0 ? void 0 : onValueChange(event, {\n                event,\n                type: 'click',\n                value: newPage === null || newPage === void 0 ? void 0 : newPage.value\n            });\n        } else {\n            onFinish === null || onFinish === void 0 ? void 0 : onFinish(event, {\n                event,\n                type: 'click',\n                value: active === null || active === void 0 ? void 0 : active.value\n            });\n        }\n    });\n    const selectPageByValue = useEventCallback((event, _value)=>{\n        setValue(_value);\n        onValueChange === null || onValueChange === void 0 ? void 0 : onValueChange(event, {\n            event,\n            type: 'click',\n            value: _value\n        });\n    });\n    return {\n        carouselRef: useMergedRefs(rootRef, carouselRef),\n        carousel: {\n            store,\n            value,\n            selectPageByDirection,\n            selectPageByValue\n        }\n    };\n}\n"],"names":["useCarousel_unstable","options","onValueChange","onFinish","ref","carouselRef","walker","carouselWalker","useCarouselWalker_unstable","store","React","useState","createCarouselStore","value","setValue","useControllableState","defaultState","defaultValue","state","initialState","rootRef","useRef","process","env","NODE_ENV","useEffect","console","error","_rootRef_current","allItems","current","querySelectorAll","CAROUSEL_ITEM","i","length","addValue","item","getAttribute","clear","config","attributes","attributeFilter","childList","subtree","callback","mutationList","mutation","addedNode","Array","from","addedNodes","isHTMLElement","hasAttribute","newValue","newNode","find","previousNode","prevPage","_previousNode_value","insertValue","removedNode","removedNodes","removedValue","removeValue","observer","MutationObserver","observe","disconnect","selectPageByDirection","useEventCallback","event","direction","active","newPage","nextPage","type","selectPageByValue","_value","useMergedRefs","carousel"],"mappings":"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"}